---
科目: 
课程名称: 
tags: []
一轮复习情况: 进行中
二轮复习情况: 未开始
三轮复习情况: 未开始
难度: 
考频: 
备注:
---

# 02 分支结构程序

# C语言 #基础 #分支结构 #条件判断 #运算符

> [!NOTE] 学习目标
> *   掌握关系运算符的使用，理解如何进行数值比较。
> *   掌握逻辑运算符的使用，理解如何进行复杂条件判断。
> *   熟练运用 `if` 语句（单分支、双分支、多分支）实现条件判断。
> *   熟练运用 `switch` 语句实现多分支选择，并理解其与 `if` 的异同。

## 02-1 关系运算符：比较大小的"裁判"

关系运算符（Relational Operators）用于比较两个表达式的大小关系。它们的结果是**布尔值**（在C语言中，通常用**0表示假，非0表示真**）。

| 运算符  | 含义   | 示例 (`a=5, b=3`)   | 结果 (在C语言中) |
| :--- | :--- | :---------------- | :--------- |
| ==   | 等于   | `a == b` (5 == 3) | `0` (假)    |
| `!=` | 不等于  | `a != b` (5 != 3) | `1` (真)    |
| `>`  | 大于   | `a > b` (5 > 3)   | `1` (真)    |
| `<`  | 小于   | `a < b` (5 < 3)   | `0` (假)    |
| `>=` | 大于等于 | `a >= b` (5 >= 3) | `1` (真)    |
| `<=` | 小于等于 | `a <= b` (5 <= 3) | `0` (假)    |

> [!WARNING] 注意：= 和 == 的区别！
> *   = 是**赋值运算符**：将右边的值赋给左边的变量。例如 `a = 5;`
> *   == 是**关系运算符**：判断两边的值是否相等。例如 `a == b`
> 
> 这是初学者最容易混淆和犯错的地方！在条件判断中，如果本该用 == 却误用了 =，编译器通常不会报错，但程序的逻辑会完全错误，这会导致难以发现的Bug！
>
> ```c
> int x = 10;
> if (x = 5) { // 错误！这里是赋值操作，将5赋给x。表达式(x=5)的值为5（非0），所以条件永远为真！
>     printf("x现在是5。\n");
> }
> // x的值变成了5，而不是判断x是否等于5
> ```
> 正确的写法应该是 `if (x == 5)`。

### 优先级和结合性

* 关系运算符的优先级低于算术运算符，但高于赋值运算符。
    * 例如：`a > b + 1` 会先计算 `b + 1`，再用 `a` 与结果比较。
* == 和 `!=` 的优先级低于 `>`，`<`，`>=`，`<=`。
* 所有关系运算符都是从左到右结合。

## 02-2 逻辑运算符：复杂条件的"指挥家"

逻辑运算符（Logical Operators）用于将多个关系表达式或布尔值组合起来，形成更复杂的条件。它们也返回布尔值（0或非0）。

| 运算符 | 含义     | 示例 (`a=5, b=3`) | 结果 (在C语言中) | 描述               |
| :----- | :------- | :---------------- | :--------------- | :----------------- |
| `&&`   | 逻辑与 (AND) | `(a > 0 && b < 10)` | `1` (真)         | 两边都为真时结果为真 |
| `\|\|`   | 逻辑或 (OR)  | `(a < 0 \|\| b > 0)`  | `1` (真)         | 两边至少一个为真时结果为真 |
| `!`    | 逻辑非 (NOT) | `!(a == b)`       | `1` (真)         | 真变假，假变真     |

* **`&&` (逻辑与)**：
    * 只有当所有条件都为真时，整个表达式才为真。
    * **短路求值**：如果左侧的条件已经为假，则右侧的条件不会再被求值，因为无论右侧是真是假，整个 `&&` 表达式的结果都将是假。
* **`||` (逻辑或)**：
    * 只要有一个条件为真，整个表达式就为真。
    * **短路求值**：如果左侧的条件已经为真，则右侧的条件不会再被求值，因为无论右侧是真是假，整个 `||` 表达式的结果都将是真。
* **`!` (逻辑非)**：
    * 对一个条件取反。如果条件为真，结果为假；如果条件为假，结果为真。

### 优先级和结合性

* `!` 的优先级最高，高于所有其他逻辑运算符和关系运算符（但低于算术运算符）。
* `&&` 的优先级高于 `||`。
* 所有逻辑运算符都是从左到右结合。

> [!TIP] 逻辑运算符与整数值
> 在C语言中，任何非零值都被视为"真"，零值被视为"假"。所以逻辑运算符不仅可以用于关系表达式，也可以直接用于整型数值。
> ```c
> int x = 5, y = 0;
> if (x && y) { // x为真，y为假，所以x && y为假
>     // 不会执行
> }
> if (x || y) { // x为真，y为假，所以x || y为真
>     // 会执行
> }
> if (!y) { // y为假，!y为真
>     // 会执行
> }
> ```

## 02-3 `if` 语句：程序世界的"决策者"

`if` 语句是C语言中最基本的条件控制语句，它允许程序根据条件的真假来选择性地执行代码块。

### 1. 单分支 `if` 语句

当条件为真时执行一块代码，否则跳过。

* **语法**：

    ```c
    if (条件表达式) {
        // 当条件表达式为真时执行的代码块
    }
    // 如果只有一条语句，可以省略花括号，但不推荐，容易出错
    // if (条件表达式)
    //    单条语句;
    ```

* **示例**：

    ```c
    int score = 85;
    if (score >= 60) {
        printf("考试通过！\n");
    }
    printf("学习继续。\n"); // 这句话无论如何都会执行
    ```

### 2. 双分支 `if-else` 语句

当条件为真时执行一个代码块，否则（条件为假时）执行另一个代码块。

* **语法**：

    ```c
    if (条件表达式) {
        // 当条件表达式为真时执行的代码块
    } else {
        // 当条件表达式为假时执行的代码块
    }
    ```

* **示例**：

    ```c
    int age = 17;
    if (age >= 18) {
        printf("您已成年。\n");
    } else {
        printf("您是未成年人。\n");
    }
    ```

### 3. 多分支 `if-else if-else` 语句

用于处理多个互斥条件的情况，程序会从上到下依次检查条件，一旦某个条件为真并执行了对应的代码块，其余的 `else if` 和 `else` 分支都会被跳过。

* **语法**：

    ```c
    if (条件表达式1) {
        // 当条件表达式1为真时执行的代码块
    } else if (条件表达式2) {
        // 当条件表达式1为假，且条件表达式2为真时执行的代码块
    } else if (条件表达式3) {
        // 当条件表达式1、2为假，且条件表达式3为真时执行的代码块
    }
    // … 可以有任意多个 else if
    else {
        // 当所有条件表达式都为假时执行的代码块 (可选)
    }
    ```

* **示例**：

    ```c
    int score = 75;
    if (score >= 90) {
        printf("优秀\n");
    } else if (score >= 80) { // 注意：这里只会检查80-89分的情况，因为90+分已被上面if分支处理
        printf("良好\n");
    } else if (score >= 60) { // 这里只会检查60-79分的情况
        printf("及格\n");
    } else {
        printf("不及格\n");
    }
    ```

### 4. `if` 语句的嵌套

`if` 语句可以相互嵌套，形成更复杂的判断逻辑。

* **示例**：

    ```c
    int gender = 1; // 1代表男，0代表女
    int age = 25;

    if (gender == 1) { // 如果是男性
        if (age >= 18 && age <= 60) {
            printf("男性成年劳动力。\n");
        } else {
            printf("男性其他年龄段。\n");
        }
    } else { // 如果是女性
        if (age >= 18 && age <= 55) {
            printf("女性成年劳动力。\n");
        } else {
            printf("女性其他年龄段。\n");
        }
    }
    ```

    > [!TIP] 嵌套时使用花括号  
    > 无论 `if` 或 `else` 后面只有一条语句，都**强烈推荐**使用花括号 `{}` 将代码块括起来。这样可以避免悬空 `else` (dangling else) 问题，让代码逻辑更清晰，也更不容易出错。

## 02-4 `switch` 语句：高效的多路选择器

`switch` 语句是另一种多分支选择结构，它允许程序根据一个表达式的值，从多个备选方案中选择一个来执行。它通常用于等值判断，比使用多个 `if-else if` 链条更简洁和高效。

### 1. 语法

* **语法**：

    ```c
    switch (表达式) { // 表达式的值必须是整型或字符型（它们本质上也是整型）
        case 常量表达式1:
            // 当表达式的值等于常量表达式1时执行的代码
            break; // 结束switch语句
        case 常量表达式2:
            // 当表达式的值等于常量表达式2时执行的代码
            break;
        // … 可以有任意多个 case
        default: // (可选) 当表达式的值不匹配任何case时执行的代码
            // 默认执行的代码
            break; // 习惯上也加上break，虽然default是最后一个
    }
    ```

* **重要规则**：
    1. `switch` 后面的**表达式**可以是任何整型类型（`char`, `short`, `int`, `long`, `enum`），**不能是浮点型或字符串型**。
    2. `case` 后面的**常量表达式**必须是**整型或字符型常量**，并且必须是**唯一**的，不能重复。
    3. **`break` 关键字**：非常重要！它用于**跳出 `switch` 语句**。如果没有 `break`，程序会继续执行下一个 `case` 的代码，直到遇到 `break` 或 `switch` 语句结束（这种现象称为**"穿透"或"fall-through"**）。
    4. **`default` 关键字**：是可选的。当 `switch` 表达式的值不与任何 `case` 的值匹配时，就会执行 `default` 分支的代码。如果没有 `default` 分支，且所有 `case` 都不匹配，则 `switch` 语句不会执行任何代码。

### 2. 示例

```c
int day = 3;
switch (day) {
    case 1:
        printf("星期一\n");
        break;
    case 2:
        printf("星期二\n");
        break;
    case 3:
        printf("星期三\n");
        break; // 没有break的话，会继续输出“星期四”
    case 4:
        printf("星期四\n");
        break;
    case 5:
        printf("星期五\n");
        break;
    default:
        printf("周末或无效输入\n");
        break;
}
// 输出：星期三
```

### 3. `switch` 语句的"穿透" (Fall-through)

利用 `switch` 的"穿透"特性，可以实现某些灵活的逻辑，但需要非常小心。

* **示例**：判断一个字母是元音还是辅音（利用了多个 `case` 执行相同操作）

    ```c
    char ch = 'E';
    switch (ch) {
        case 'A':
        case 'a':
        case 'E': // ch为'E'时匹配到这里
        case 'e': // 没有break，会继续执行这里的语句，然后fall-through到下一个case
        case 'I':
        case 'i':
        case 'O':
        case 'o':
        case 'U':
        case 'u':
            printf("%c 是元音字母。\n", ch);
            break; // 在这里跳出
        default:
            printf("%c 是辅音字母。\n", ch);
            break;
    }
    // 输出：E 是元音字母。
    ```

    > [!WARNING] 小心"穿透"！  
    > 如果你**忘记**写 `break`，而又不是故意想利用"穿透"特性，那么就可能导致逻辑错误！这是 `switch` 语句常见的错误来源之一。

### 4. `if` 与 `switch` 的选择

* **`if` 语句**：
    * **更通用**：可以处理任何类型的条件表达式，包括复杂的逻辑判断（例如范围判断 `score >= 60 && score < 70`）。
    * **更灵活**：条件可以是任意布尔表达式。
* **`switch` 语句**：
    * **更简洁高效**：当进行基于单个变量的**等值判断**时，`switch` 语句通常比一长串 `if-else if` 更清晰、更易读，并且编译器可能对其进行更优化的处理。
    * **限制**：只能用于整型或字符型表达式的等值判断。

**总结**：
* 当条件是**范围判断**（如 `x > 10`）或复杂的**逻辑组合**（如 `x > 0 && y < 10`）时，使用 `if` 语句。
* 当进行基于一个变量的**多值等值判断**时，`switch` 语句是更好的选择。
