---
科目: 
课程名称: 
tags: []
一轮复习情况: 进行中
二轮复习情况: 未开始
三轮复习情况: 未开始
难度: 
考频: 
备注:
---

> [!abstract] ## 06-1 总线概述
> * (一)总线概述
>    1. [[#1. 总线的基本概念|总线的基本概念]]
>    2. [[#2. 总线的分类|总线的分类]] (片内/系统/通信；并行/串行；物理结构)
>    3. [[#3. 系统总线的基本结构|系统总线的基本结构]] (数据/地址/控制总线)
>    4. [[#4. 总线的特性|总线的特性]]
>    5. [[#5. 总线的性能指标|总线的性能指标]]
>    6. [[#6. 总线的事务和定时|总线的事务和定时]]

---

### **06-1 总线概述**

#### **1. 总线的基本概念**

CPU、主存、硬盘、打印机……计算机内部有众多硬件部件，它们之间需要相互"对话"来交换信息。**总线 (Bus)** 就是承载这些信息传输的"道路"和"桥梁"。

*   **定义**：总线是一组能为多个部件**分时共享**的**信息传送线路**。
    *   **共享**：总线上可以挂接多个部件（例如CPU、主存、I/O接口），各个部件之间互相交换的信息都可以通过这组线路分时共享。
    *   **分时**：在同一时刻，总线只允许**一个部件向总线发送信息**，但是可以有**多个部件接收信息**。如果系统中有多个部件需要发送信息，则它们只能分时地向总线发送信息。

*   **为什么要用总线？**
    *   早期计算机：外部设备少时大多采用分散连接方式（点对点），这种方式**不易实现随时增减外部设备**。
    *   发展至今：为了更好地解决I/O设备和主机之间连接的灵活性问题，计算机的结构从分散连接发展为**总线连接**，大大简化了系统的设计和扩展。
> [!key] 总线定义 (三要素)
> 1.  **共享 (Shared)**：总线上可挂接多个部件。
> 2.  **分时 (Time-Division)**：同一时刻只允许**一个部件发送**信息，可有**多个部件接收**信息。
> 3.  **信息传输**：是一组传输线路。

#### **2. 总线的分类**

总线可以从不同的角度进行分类：
##### (1) 按总线在计算机系统中的位置

1.  **片内总线 (On-chip Bus)**：
    *   位于CPU芯片内部。
    *   是CPU芯片内部寄存器与寄存器之间、寄存器与ALU之间的公共连接线。
    *   速度最快，结构最精简。
2.  **系统总线 (System Bus)**：
    *   是计算机系统内各功能部件（CPU、主存、I/O接口）之间相互连接的总线。
    *   是考研中最常考的总线类型。
    *   按系统总线传送信息不同，又可细分为：**数据总线、地址总线、控制总线**。
3.  **通信总线 (Communication Bus)**：
    *   用于计算机系统之间，或计算机系统与外部设备（如远程通信设备、测试设备）之间的信息传送。
    *   也称为**外部总线**。例如USB、RS-232C等。

##### (2) 按数据传输方式

1.  **并行总线 (Parallel Bus)**：
    *   **特点**：用 `m` 根信号线**同时**传送 `m` 个比特（位）数据。
    *   **优点**：总线的逻辑时序比较简单，电路实现比较容易，单位时间内传输的数据量大（在同等工作频率下比串行总线快）。
    *   **缺点**：
        *   信号线数量多，占用更多布线空间，远距离传输成本高昂。
        *   由于工作频率较高时，并行信号线之间会产生严重**干扰**（串扰），对每条线等长的要求也越高，所以**无法持续提升工作频率**。这限制了其未来发展潜力。
2.  **串行总线 (Serial Bus)**：
    *   **特点**：只需要一条或两根传输线（例如用差模信号），**每次只传送一个比特**数据。
    *   **优点**：只需要少量传输线，成本低廉，广泛应用于长距离传输，可以节省布线空间。由于只有少数几条线，线间干扰小，可以持续大幅提高工作频率来提升速度。
    *   **缺点**：在数据发送和接收的时候要进行**串并行转换**（拆卸和装配），逻辑控制相对复杂。
    *   **趋势**：随着工作频率的不断提升，串行总线的传输速度最终超过了并行总线，成为现代高速总线的主流（如PCI-E, SATA, USB）。
> [!danger] **并行总线传输速度不一定比串行总线快** #2016年
> *   **传统观念**：在低频条件下，并行总线由于多条数据线同时传输，确实具有带宽优势。
> *   **高频物理限制**：然而，随着工作频率的增加，并行总线面临严重的物理限制：
>     *   **线间串扰 (Crosstalk)**：信号线之间相互干扰，影响信号完整性。
>     *   **时钟偏斜 (Clock Skew)**：不同信号线上的时钟到达时间不一致，导致数据同步困难。
> *   这些问题限制了并行总线最高工作频率的提升。
> *   **现代趋势**：串行总线通过采用**差分信号**、**高频时钟**和**复杂的编码解码技术**，有效抑制了线间干扰和时钟偏斜，在高频环境下能够实现更高的传输速率。例如，PCIe (串行) 的速率远超传统 PCI (并行)。因此，**"并行总线传输比串行总线传输速度快"是一个错误的、过时的叙述**。

##### (3) 按系统总线的连接方式 (物理结构)

1.  **单总线结构**：
    *   **特点**：CPU、主存、I/O设备（通过I/O接口）都连接在**同一组系统总线**上。允许I/O设备之间、I/O设备和CPU之间或I/O设备与主存之间直接交换信息。
    *   **优缺点**：
        *   优点：结构简单，成本低，易于接入新的设备。
        *   缺点：**带宽低、负载重**，所有部件共享唯一总线，不支持并发传送操作，容易成为系统瓶瓶颈。
    *   **注意**：单总线并不指只有一根信号线，系统总线按传送信息不同可细分为地址总线、数据总线、控制总线。
2.  **双总线结构**：
    *   **特点**：通常有两条总线，一条是**主存总线**（或称为系统总线），用于CPU、主存和通道之间进行数据传送；另一条是**I/O总线**，用于多个外部设备与通道之间进行数据传送。
    *   **优缺点**：
        *   优点：将较低速的I/O设备从主存总线上分离出来，减轻了主存总线（系统总线）的负担，提高了主存总线的效率。
        *   缺点：需要增加**通道 (Channel)** 等硬件设备。通道是具有特殊功能的处理器，能对I/O设备进行统一管理，通道程序放在主存中。
3.  **三总线结构**：
    *   **特点**：在计算机系统各部件之间采用3条各自独立的总线来构成信息通路，这3条总线分别为**CPU总线、I/O总线**和**直接内存访问(DMA)总线**。
    *   **优缺点**：
        *   优点：进一步提高了I/O设备的性能，使其更快地响应命令，提高了系统吞吐量。
        *   缺点：系统结构复杂，成本更高。
> [!key] **多总线结构设计原则** #2017年
> *   **分层设计**：多总线结构采用层次化设计，通过不同速率的总线连接相应性能等级的设备。
> *   **性能匹配**：高速设备（如CPU、主存）连接到速度快的总线，低速设备连接到速度慢的总线。
> *   **连接方式**：总线之间必须通过**桥接器 (Bridge)** 相连，桥接器负责不同总线间的协议转换、速度匹配和缓冲功能。
> *   **距离与速度**：通常，**靠近CPU的总线速度较快**，如系统总线、存储器总线。

#### **3. 系统总线的基本结构**

系统总线按其传送信息的不同，可细分为三类：

1.  **数据总线 (Data Bus)**：
    *   **功能**：用来传输各功能部件之间的**数据信息**，它是**双向**传输总线。
    *   **位数**：总线宽度，通常与CPU的机器字长（如32位、64位）或存储字长一致。位数越多，每周期传送数据量越大。
    *   **传输内容**：指令（CPU取指阶段从内存读取）、操作数（运算过程中的数据传输）、中断类型号（中断响应时的标识数据）等数据信息。
2.  **地址总线 (Address Bus)**：
    *   **功能**：用来指出数据总线上的源数据或目的数据所在的主存单元或I/O端口的地址，它是**单向**传输总线（由CPU发出地址）。
    *   **位数**：与CPU的地址位数有关，决定了CPU能够直接寻址的内存空间大小。例如，32位地址总线可寻址 $2^{32}$ 字节的内存。
3.  **控制总线 (Control Bus)**：
    *   **功能**：传输的是控制信息，包括CPU发出的**控制信号**（如读/写命令、总线请求、中断请求）和CPU接收的**状态信号**（如设备忙/闲、中断响应）。它是**双向**传输总线。
    *   **位数**：线的根数没有统一规定，根据控制信号种类而定。
> [!danger] 易错点：数据总线传输界限 #2011年
> **握手信号、时钟信号、读/写信号**等属于**控制协议信号**，它们不承载实际数据内容，因此**不能在数据总线上传输**。这类信号专门通过**控制总线**传输。

#### **4. 总线的特性**

总线作为硬件互连的规范，需要定义其物理和电气特性：

1.  **机械特性**：尺寸、形状、管脚数、排列顺序。
2.  **电气特性**：传输方向和有效的电平范围（例如 `0~0.5V` 为低电平，`4.8~5.2V` 为高电平）。
3.  **功能特性**：每根传输线的功能（是地址线、数据线还是控制线，以及具体表示什么控制信号）。
4.  **时间特性**：信号发出和接收的时序关系（例如同步或异步）。

#### **5. 总线的性能指标**

理解这些性能指标，能帮助我们评估总线的优劣。

1.  **总线的传输周期 (Bus Cycle)**：
    *   **定义**：指总线在一次完整的数据传输操作（包括申请、寻址、传输和结束阶段）中所需的总时间。
    *   通常由若干个总线时钟周期构成。有时也可能一个总线周期就是一个总线时钟周期。
2.  **总线时钟周期 (Bus Clock Cycle)**：
    *   **定义**：总线的基本时间单位，是计算机统一时钟的周期，用于控制总线上的各个操作。
    *   **时钟频率** = $1 / \text{时钟周期}$。
3.  **总线的工作频率 (Bus Operating Frequency)**：
    *   **定义**：总线上各种操作的频率。
    *   若总线周期 = `N` 个时钟周期，则总线的工作频率 = 时钟频率 $ / N$。
    *   在DDR技术中，一个时钟周期传送2次数据，可以理解为总线的工作频率是时钟频率的2倍。
> [!info] **同步总线时钟频率与工作频率的关系** #2021年
> *   同步总线的时钟频率是**总线工作的基准频率**。
> *   总线的工作频率可以通过对时钟频率进行**分频或倍频**产生。例如，CPU的主频通常是系统总线时钟频率的整数倍。
> *   因此，**时钟频率不一定等于工作频率**，但工作频率一定由时钟频率派生。
4.  **总线宽度 (Bus Width)**：
    *   又称为数据线数。指数据总线的根数，即总线可以并行传输的比特数。
    *   例如，32根数据线称为32位 (bit) 总线。
5.  **总线带宽 (Bus Bandwidth) / 最大传输速率**： #2009年 #2019年 #2024年 #2025年
    *   **定义**：可理解为总线的数据吞吐量，即单位时间内总线上传送的**最大信息量**。
    *   通常用每秒钟传送信息的字节数来衡量，单位可用字节/秒 (B/s) 表示。
    *   **计算公式**：
        *   `总线带宽 (bit/s) = 总线工作频率 (Hz) × 总线宽度 (bit)`
        *   `总线带宽 (B/s) = 总线工作频率 (Hz) × (总线宽度 (bit) / 8)`
> [!key] 皮皮灰答题技巧：带宽计算要点 #2009年 #2019年 #2024年 #2025年
> 1.  **BW 是理论峰值**：计算时只关注硬件参数 ($f, W$)，**忽略**突发传输细节、地址/命令开销。
> 2.  **$MT/s$ 单位**：$Mega\;Transfers\;per\;Second$ 已是**有效传输频率** (已包含 $DDR, Quad-pumped$ 等倍率)，**不可再重复相乘**。
> 3.  **多通道**：总带宽 = 单通道带宽 $\times$ 通道数。
> * **最大传输速率计算：**
> | 计算步骤        | 公式应用                     | 注意事项                                   |
> | :---------- | :----------------------- | :------------------------------------- |
> | 1. 确定总线周期频率 | `总线周期频率 = 时钟频率 ÷ 每周期时钟数` | 区分总线周期与时钟周期                            |
> | 2. 确定有效传输频率 | `MT/s` 单位已包含传输倍数效果       | 避免重复乘以传输倍数 (`quad-pumped` 技术)          |
> | 3. 计算单通道带宽  | `频率 × 位宽`                | `64` 位 `= 8` 字节，单位换算要准确                |
> | 4. 计算多通道带宽  | `单通道带宽 × 通道数`            | 多个通道并行工作                               |
> | 5. 单位统一     | `MB/s → GB/s`            | `1GB = 1000MB` 或 `1024MB`（根据题目要求或工程惯例） |
> | 6. 结果近似     | 理论值与选项匹配                 | 工程计算允许近似                               |

> [!tip] **总线带宽的干扰信息** #2024年
> *   总线带宽是指**总线的固有硬件特性，反映硬件传输能力上限**。
> *   计算时仅考虑**纯数据传输阶段的峰值性能**，**不包含协议开销**（如突发传输方式、地址命令周期、具体时序安排等）。这些信息影响**有效利用率**或**实际吞吐量**，但不改变理论带宽上限。

6.  **总线复用 (Bus Multiplexing)**：
    *   **定义**：指将多路信号（如地址和数据）分时地在同一组总线上传输。
    *   可以使用较少的信号线传输更多的信息，从而节省了布线空间和成本。
    *   **示例**：地址总线和数据总线共用一组信号线。在某个时钟周期传输地址，在另一个时钟周期传输数据。
> [!key] **地址/数据线复用** #2018年
> *   **目的**：减少物理引脚数量，降低系统成本和布线复杂度。
> *   **代价**：引入额外的时钟周期进行地址/数据切换，增加传输延迟，**降低有效带宽利用率**。
7.  **信号线数**：地址总线、数据总线和控制总线这3种总线数的总和称为信号线数。

#### **6. 总线的事务和定时**

总线事务 (Bus Transaction) 指的是一次完整的总线操作，它通常包括请求、寻址、数据传输和结束等阶段。总线定时 (Bus Timing) 则是指总线在双方交换数据的过程中需要时间上配合关系的控制，它实质是一种协议或规则。

> [!info] **总线仲裁 (Bus Arbitration) ** #已从2026年408大纲删除
> *   **说明**：根据2026年408考研大纲，总线仲裁内容已**被删除**。因此，此处不进行详细展开。考生可重点关注总线定时和I/O方式（I/O方式已移至07笔记）。

> [!info] **总线标准** #已从2026年408大纲删除
> *   **说明**：根据2026年408考研大纲，总线标准相关内容已**被删除**。因此，此处不进行详细展开。考生可重点关注总线定时。
> *   **总线发展趋势**：需要了解从**并行总线向串行总线发展**的趋势，以及其背后的技术原因（如串扰、时钟偏斜等问题限制了并行总线在高频下的性能，串行总线通过提高频率、差分信号和包传输等技术实现更高带宽）。

##### (1) 总线通信的几种方式

总线周期通常包含以下四个阶段：申请/仲裁阶段、寻址阶段、传输阶段、结束阶段。不同的总线通信方式，其阶段的时序配合有所不同。

*   **同步通信 (Synchronous Communication)**： #2015年 #2018年 #2021年
    *   **特点**：系统采用一个**统一的时钟信号**来协调发送和接收双方的传送定时关系。所有部件或设备发送或接收信息都在固定的总线传送周期中进行。
    *   **优点**：传送速度快，具有较高的传输速率；总线控制逻辑简单。
    *   **缺点**：主从设备是强制性同步，不能适应工作速度差异大的部件；不能及时进行数据通信的有效性检验，可靠性较差。
    *   **适用场景**：适用于高速且总线长度较短的系统。
> [!danger] **同步时钟信号由系统统一提供** #2015年
> *   同步通信的本质是所有设备都由**一个统一的时钟源**协调工作。
> *   因此，同步时钟信号必须由**总线控制器或系统时钟发生器统一提供**，而**不能由各设备各自提供**，否则将导致时序混乱和通信失败。
*   **异步通信 (Asynchronous Communication)**： #2015年 #2021年
    *   **特点**：**没有统一时钟**，也没有固定的时间间隔。完全依靠传送双方相互制约的**"握手"信号**（请求信号和回答信号）来实现定时控制。
    *   **优点**：总线周期长度可变，能保证工作速度相差很大的部件或设备之间可靠地进行信息交换，自动适应时间的配合。
    *   **缺点**：比同步控制方式稍复杂，速度比同步定时方式慢。
    *   **"请求"和"回答"信号的撤销互锁方式**：
        *   **不互锁方式**：主设备发出请求后不必等回答，一段时间后撤销请求。从设备接到请求后发出回答，一段时间后撤销回答。双方不存在互锁关系。**速度最快，可靠性最差**。
        *   **半互锁方式**：主设备发出请求后，必须待接到从设备的回答后才撤销请求（有互锁）。从设备发出回答后，不必等待主设备撤销请求，一段时间后自动撤销回答（无互锁）。
        *   **全互锁方式**：主设备发出请求后，必须待从设备回答后才撤销请求。从设备发出回答后，必须待获知主设备请求信号已撤销后，再撤销其回答信号。**最可靠，速度最慢**。
> [!key] **异步总线握手传输单位** #2021年
> *   异步总线由握手信号定时，但**一次握手过程完成的是一个完整数据单元的交换**（如字节、字、双字），而**不是仅仅一位数据**。
> *   握手协议确保了每次数据传输的可靠性，每次握手都会传输总线宽度所能承载的全部数据。
*   **半同步通信 (Half-Synchronous Communication)**： #2015年
    *   **特点**：在统一时钟的基础上，增加一个**"等待"响应信号 (WAIT)**。
    *   **原理**：发送方发出信号后，如果接收方没准备好，可以通过拉低WAIT信号让发送方等待。
    *   **优缺点**：兼具同步通信速度快和异步通信灵活适应的优点。
    *   **握手信号采样**：在半同步通信方式中，握手信号的采样由**同步时钟控制**，确保了同步的定时确定性。
*   **分离式通信 (Split Transaction Bus)**： #2016年
    *   **共同点**：上述三种通信方式都是在"一个总线传输周期"内完成所有操作。
    *   **分离式通信**：将一个总线传输周期分解为两个子周期：
        *   **子周期1 (请求阶段)**：主模块申请占用总线，发出地址、命令，然后放弃总线使用权（总线空闲）。
        *   **子周期2 (响应阶段)**：从模块准备好数据后，申请占用总线，将数据送至总线。
    *   **特点**：
        *   各模块均有权申请占用总线。
        *   采用同步方式通信，不等对方回答。
        *   各模块准备数据时，不占用总线。
        *   总线利用率提高：因为在从模块准备数据的时间里，总线可以被其他主模块使用。
    *   **优点**：显著提高总线利用率。
    *   **缺点**：控制复杂，需要主从模块都有总线仲裁能力。

##### (2) 突发传输 (Burst Transfer)
#2012年 #2014年 #2018年 #2021年 #2023年
*   **概念定义**：一种高效的总线数据传输方式。主设备只需给出一个**首地址**，从设备就能从该首地址开始，连续读出或写入**多个数据单元**。
*   **技术优势**：
    *   **减少地址开销**：通过**地址复用机制**，避免了重复发送地址信号。
    *   **提高总线利用率**：减少了地址传输和握手协议的开销，显著提升了连续数据访问的效率。
    *   **批量操作**：非常适合传输大块连续数据（如Cache行填充、DMA传输）。
*   **存储器总线支持**：存储器总线（连接CPU与主存）通常支持突发传输，以提高内存带宽和数据吞吐量。
*   **时间消耗计算** #2012年 #2023年
    *   **计算步骤**：
        1.  **时钟周期计算**：$T = 1/f$
        2.  **地址传输时间**：通常为 `1` 个时钟周期（对于地址/数据复用总线）。
        3.  **数据传输周期数**：`总数据量 ÷ 总线宽度`
        4.  **数据传输时间**：`数据传输周期数 × 时钟周期`
        5.  **总传输时间**：`地址传输时间 + 数据传输时间` (若不支持突发传输，则每次传输都需地址传输开销)
    *   **注意要点**：
        *   频率与周期互为倒数关系。
        *   **地址/数据复用总线**需要专门的地址周期。
        *   **总数据量**与**总线宽度**单位统一（位或字节）。
        *   **不支持突发传输**时，每次传输都需要完整的"地址-准备-数据"过程，导致多次完整的传输时间累加。
> [!key] 核心优化技术对比
> | 技术名称 | 目标 | 效果 | 关键机制 | 传输率影响 |
> | :--- | :--- | :--- | :--- | :--- |
> | **突发传输** (Burst) | 提高连续访问效率 | **提高**数据传输率 | **单次地址，多次数据**连续传输 (#2014年) | **提高** (减少地址开销) |
> | **地址/数据复用** | 减少信号线数量 | **降低**有效传输率 | 同一组线分时传输地址和数据 | **降低** (增加时序开销) |
> | **分离事务** (Split) | 提高总线利用率 | **提高**并发性 | 请求和响应分两次总线事务完成 | **提高** (等待不占总线) |

---
