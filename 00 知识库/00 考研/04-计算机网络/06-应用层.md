---
科目: "408"
课程名称: 计算机网络
tags: [应用层]
一轮复习情况: 未开始
二轮复习情况: 未开始
三轮复习情况: 未开始
难度: -1
考频:
备注:
---

>[!abstract] 26大纲
> - (一)[[#06-1 网络应用模型|网络应用模型]] 
> 	1. 客户/服务器(C/S)模型 
> 	2. 对等(P2P)模型
> - (二)[[#06-2 域名系统 (DNS)|DNS 系统]]
> 	1. 层次域名空间 
> 	2. 域名服务器 
> 	3. 域名解析过程 #常考
> - (三)[[#06-3 文件传输协议 (FTP)|FTP]] 
> 	1. FTP 协议的工作原理 
> 	2. 控制连接与数据连接
> - (四)[[#06-4 电子邮件|电子邮件]] #常考
> 	1. 电子邮件系统的组成结构
> 	2. 电子邮件格式与 MIME
> 	3. SMTP 协议与 POP3 协议
> - (五)[[#06-5 万维网 (WWW)|WWW]] 
> 	1. WWW 的概念与组成结构 
> 	2. HTTP 协议

# 06-应用层

## 06-1 网络应用模型

### 1. 客户端/服务器模型 (C/S模型)
#CS模型 #客户端服务器模型 #2019年
*   **核心思想**：#ClientServer 将应用程序的功能划分为两部分，一部分作为**客户端（Client）**，另一部分作为**服务器（Server）**。
    *   **客户端**：发起请求，请求服务器提供服务。通常是用户与应用程序交互的界面。**主动发起通信**。
    *   **服务器**：提供服务，响应客户端的请求。通常运行在高性能主机上，等待客户端连接。**被动通信**。
*   **特点**：
    *   **节点关系**：主从（Client-Server）关系。
    *   **中心化**：服务器是核心，所有服务和数据通常集中在服务器上。
    *   **通信路径**：客户端之间**不能直接通信**，所有通信必须通过中央服务器中转。
    *   **管理与维护**：服务器端集中管理，便于升级和安全控制，安全性较高。
    *   **可伸缩性**：通过增加服务器数量或提升服务器性能可以提高服务能力，但服务器容易成为性能瓶颈，系统扩展能力受服务器限制。
*   **优点**：功能分布专业，数据集中管理，易于维护和备份，易于扩展。
*   **缺点**：服务器容易成为性能瓶颈（#单点故障），服务器的故障可能导致整个系统不可用，对服务器硬件和软件要求较高。
*   **常见应用**：#CS应用场景 Web服务（浏览器↔Web服务器）、FTP（文件传输协议）、电子邮件（客户端↔邮件服务器）、DNS（域名系统）、数据库访问。

### 2. 对等网络模型 (P2P模型)
#P2P模型 #对等网络模型 #2019年
*   **核心思想**： #PeerToPeer 网络中的所有主机（对等方/Peer）都具有相同的地位，既是服务的请求者（客户端），又是服务的提供者（服务器）。
*   **特点**：
    *   **节点关系**：对等（Peer）关系，具有相同的功能角色和权限级别。
    *   **通信发起**：任意节点都可以主动发起通信。
    *   **去中心化**：没有固定的中央服务器，每个对等方直接与其他对等方通信。
    *   **自组织**：对等方之间可以动态地加入和离开网络。
    *   **高可用性和健壮性**：部分节点故障不会影响整个网络的运行，具有高容错性。
    *   **可伸缩性强**：随着用户数量增加，整体服务能力也随之增强，具有带宽聚合效应。
    *   **数据分发**：在向多用户分发一个文件时，P2P模型通常比C/S模型所需的时间短（支持从多个Peer并发下载不同片段，下载负载分散）。
*   **优点**：减轻服务器负担，资源共享更广泛，效率高。
*   **缺点**：管理和安全控制相对困难，查找资源可能需要更复杂的机制，对等方的可靠性和带宽不稳定。
*   **常见应用**：#P2P应用场景 文件共享（如BitTorrent）、VoIP电话（如Skype的某些功能）、分布式存储。

## 06-2 域名系统 (DNS)

### 1. DNS的作用
#DNS #域名系统 #2010年 #2016年 #2020年
*   **功能**：将用户友好的**域名 (Domain Name)** 转换为机器可识别的 **#IP地址**。
    *   例如，将`www.example.com`解析为`192.0.2.1`。
*   **重要性**：没有DNS，我们就需要记住每个网站的IP地址才能访问。
*   **本质**：一个分布式、层次化的数据库系统。

### 2. 域名结构和层次结构
#域名结构 #域名层次 #2016年
*   **域名结构**：由点分隔的字符串组成，从右到左，级别逐渐升高。
    *   `主机名.三级域名.二级域名.顶级域名.`
    *   例如：`www.baidu.com.`
        *   `根域 (.)`：最高层级。
        *   `顶级域名 (TLD, Top-Level Domain)`：如.com, .org, .cn, .edu等。
        *   `二级域名 (SLD, Second-Level Domain)`：由机构注册。
        *   `主机名 (Host Name)`：特定服务器。

### 3. DNS服务器类型
#DNS服务器 #2010年 #2016年 #2020年
1.  **根域名服务器 (Root DNS Server)**： #根域名服务器
    *   全球有13组，它们知道所有**顶级域名服务器**的IP地址。
    *   当本地DNS服务器无法解析时，会首先查询根域名服务器。
2.  **顶级域名服务器 (TLD DNS Server)**： #顶级域名服务器
    *   负责管理在该顶级域名下注册的所有二级域名服务器的IP地址。
    *   例如，.com TLD服务器知道baidu.com的权威DNS服务器的地址。
3.  **权威域名服务器 (Authoritative DNS Server)**： #权威域名服务器
    *   负责维护一个或多个特定域名的所有DNS记录（如baidu.com）。它拥有该域名最准确的IP地址信息。
    *   由域名注册者或其托管商运行。
4.  **本地DNS服务器 (Local DNS Server/Resolver)**： #本地DNS服务器 #DNS解析器
    *   也称为DNS解析器，是离用户最近的DNS服务器，通常由ISP（互联网服务提供商）提供或由企业/学校自己架设。
    *   它不属于DNS的层次结构，但对用户的DNS查询至关重要，**代理用户查询**。
    *   它会缓存查询结果，加速后续查询。

### 4. DNS查询过程
#DNS查询 #2010年 #2016年 #2020年 #常考
*   **递归查询 (Recursive Query)**： #递归查询
    *   **查询特征**：完整解析责任，单向请求响应。
    *   当本地DNS服务器收到一个递归查询请求时，它会代为完成所有后续的查询，直到获得最终答案，然后返回给客户端。服务器负责完整解析。
    *   **用户主机**通常向本地DNS服务器发起递归查询，发送**一条**请求消息，并设置DNS消息头部RD(Recursion Desired)位为1，等待最终响应。
    *   **本地域名服务器**接收用户查询后，若无缓存，向根域名服务器发送**一条**递归查询请求，并等待根服务器返回最终结果（根服务器内部进行迭代查询）。
*   **迭代查询 (Iterative Query)**： #迭代查询
    *   **查询特征**：逐级引导查询，多轮交互。
    *   当DNS服务器收到一个迭代查询请求时，如果它无法直接提供答案，它会返回一个它知道的、更接近目标域名的DNS服务器地址给请求方。请求方会再向新的DNS服务器发起查询，直到找到答案。客户端逐级查询。
    *   根域名服务器、TLD服务器通常处理迭代查询。
*   **混合查询**： #混合查询 本地DNS服务器对用户主机执行递归查询，而本地DNS服务器向上级（根、TLD、权威）服务器执行迭代查询。
*   **无缓存时的解析流程（迭代查询）**： #无缓存解析 #2010年 #2016年
    1.  用户在浏览器输入`www.example.com`。
    2.  浏览器查询本地DNS服务器（递归查询）。
    3.  本地DNS服务器检查缓存，若无，则向根域名服务器发起查询（迭代查询）。
    4.  根域名服务器返回`.com`顶级域名服务器的IP地址。
    5.  本地DNS服务器向`.com`顶级域名服务器发起查询。
    6.  `.com`顶级域名服务器返回`example.com`权威域名服务器的IP地址。
    7.  本地DNS服务器向`example.com`权威域名服务器发起查询。
    8.  `example.com`权威域名服务器返回`www.example.com`的IP地址。
    9.  本地DNS服务器将IP地址缓存，并返回给浏览器。
    10. 浏览器使用该IP地址访问Web服务器。
*   **DNS解析时延**： #DNS时延 #2020年
    *   **最优场景（0 RTT）**：本地DNS服务器缓存命中目标域名记录，或主机DNS缓存命中。
    *   **最劣场景（3 RTT）**：完整的DNS迭代查询链路，依次查询根、TLD、权威DNS服务器（每个查询1 RTT）。

### 5. DNS记录类型
#DNS记录类型
*   **A记录 (Address Record)**：将域名映射到 #IPv4地址。
*   **AAAA记录 (IPv6 Address Record)**：将域名映射到 #IPv6地址。
*   **NS记录 (Name Server Record)**：指定负责该域名的权威DNS服务器。
*   **MX记录 (Mail Exchange Record)**：指定该域名的邮件服务器。
*   **CNAME记录 (Canonical Name Record)**：#CNAME记录 #别名记录 将一个域名映射到另一个域名（别名）。CNAME记录可能增加额外的查询次数。

### 6. DNS缓存
#DNS缓存
*   本地DNS服务器会缓存DNS查询结果，以提高查询速度和减轻上级DNS服务器的负担。
*   每个DNS记录都有一个 #TTL (Time To Live) 值，表示缓存的有效时间。

## 06-3 文件传输协议 (FTP)

### 1. FTP的功能和特点
#FTP #文件传输协议 #2009年 #2017年
*   **功能**：在客户端和服务器之间传输文件。
*   **特点**：
    *   **支持交互式访问**：用户可以在远程主机上进行文件目录浏览、创建、删除等操作。
    *   **独立于操作系统**：可以在不同操作系统之间传输文件。
    *   **独立于文件系统**：支持不同的文件结构和编码。

### 2. FTP的架构
#FTP架构 #2009年 #2017年
*   FTP采用**C/S模型**，并使用**两个并行的TCP连接**进行文件传输，这是其独特之处：
    1.  **控制连接 (Control Connection)**： #控制连接
        *   **功能**：专门用于传输FTP命令和响应（如用户登录、文件列表请求、上传/下载命令等）。
        *   **协议与端口**：建立在 **TCP 之上**，使用TCP端口 **21**。
        *   **生命周期**：**持久连接**，在整个FTP会话期间保持打开状态，直到用户退出FTP。
        *   **特征**：维护整个FTP会话的状态信息，命令传输要求可靠性和顺序保证。
    2.  **数据连接 (Data Connection)**： #数据连接
        *   **功能**：专门用于实际传输文件数据和目录列表。
        *   **协议与端口**：建立在 **TCP 之上**，使用的端口根据传输模式不同（主动模式服务器使用端口 **20**，被动模式服务器使用随机端口）。
        *   **生命周期**：**临时连接**，按需创建，每次文件传输请求会创建一个新的数据连接，传输完毕后立即关闭。

### 3. FTP的数据连接模式
#FTP数据连接模式 #2017年

*   **主动模式 (Active Mode)**： #主动模式
    1.  客户端向服务器的**控制端口21**发起连接。
    2.  客户端发送 `PORT` 命令，告诉服务器一个客户端的**数据监听端口N**（临时端口）。
    3.  服务器从其TCP端口 **20** 主动连接客户端的端口N，建立数据连接。
    *   **问题**：客户端防火墙可能会阻止服务器主动连接客户端的随机端口。
*   **被动模式 (Passive Mode)**：#被动模式
    1.  客户端向服务器的**控制端口21**发起连接。
    2.  客户端发送 `PASV` 命令，告诉服务器进入被动模式。
    3.  服务器开启一个随机的**数据监听端口M**，并将其端口M通知给客户端。
    4.  客户端主动连接服务器的端口M，建立数据连接。
    *   **优点**：解决了客户端防火墙的问题，因为所有连接都由客户端发起。

### 4. FTP用户认证
#FTP认证
*   通常需要用户名和密码进行身份验证。
*   支持匿名FTP（Anonymous FTP），使用`anonymous`作为用户名，任意字符串作为密码。

## 06-4 电子邮件

### 1. 电子邮件系统组成
#电子邮件系统 #2012年
*   **用户代理 (User Agent, UA)**：#用户代理
    *   用户与电子邮件系统交互的界面，即我们常用的邮件客户端软件（如Outlook, Foxmail, Gmail网页版等）。
    *   负责邮件的编辑、发送、接收、阅读、回复、转发等。
*   **邮件服务器 (Mail Server)**：#邮件服务器
    *   存储和管理用户的邮箱（收件箱、发件箱等）。
    *   负责邮件的发送和接收，充当邮件的"中转站"。
    *   通常包含一个 #SMTP服务器 (用于发送和接收邮件) 和一个 #POP3服务器 或 #IMAP服务器 (用于用户接收邮件)。

### 2. 电子邮件协议
#电子邮件协议 #2012年

#### 2.1 发送邮件协议：SMTP (Simple Mail Transfer Protocol)
#SMTP #2012年 #2013年 #2018年
*   **功能**：
    *   用于邮件客户端（用户代理MUA）向邮件服务器（MTA）发送邮件。
    *   用于邮件服务器之间（MTA之间）发送邮件。
*   **特点**：
    *   **基于TCP**，使用TCP端口 **25** (用于服务器间转发)，或 **587/465** (用于客户端向服务器提交邮件，支持认证和加密)。
    *   **推（Push）协议**：客户端或发送方服务器将邮件"推"给接收方服务器。
    *   **编码限制**：原始SMTP（RFC 5321）**只支持传输 7 比特 ASCII 码内容**。不能直接传输二进制文件或非英文字符。
    *   **MIME扩展**：通过 #MIME 扩展，将非ASCII码内容编码成ASCII码（如Base64），才能通过SMTP传输。
    *   **传输方向**：支持从用户代理向邮件服务器发送邮件；支持在邮件服务器之间发送邮件。**不支持**从邮件服务器向用户代理发送邮件（SMTP是推送协议，不提供拉取服务）。
*   **工作过程**：
    1.  发件人用户代理将邮件提交给本地SMTP服务器。
    2.  本地SMTP服务器与收件人域名的SMTP服务器建立TCP连接。
    3.  本地SMTP服务器向远程SMTP服务器发送邮件（命令和数据）。
    4.  远程SMTP服务器接收邮件并将其放入收件人的邮箱中。

#### 2.2 接收邮件协议：POP3 (Post Office Protocol version 3) 和 IMAP (Internet Message Access Protocol)

*   **POP3 (Post Office Protocol version 3)**： #POP3 #2012年 #2015年 #2025年
    *   **功能**：允许用户代理从邮件服务器上**下载**邮件。
    *   **特点**：
        *   **基于TCP**，使用TCP端口 **110** (或995 for POP3S)。
        *   **拉（Pull）协议**：客户端从服务器"拉取"邮件。
        *   **传输服务类型**：提供**有连接可靠的数据传输服务**。
        *   **"下载并删除"模式**：邮件通常从服务器下载到本地后，服务器上的副本会被删除（尽管现代POP3也支持保留副本）。
        *   **离线操作**：一旦下载到本地，用户可以在离线状态下阅读和管理邮件。
        *   **连接复用**：支持**一条TCP连接接收多封邮件**（在同一会话中执行多次RETR命令）。
    *   **限制**：不支持用户代理向邮件服务器发送邮件；不支持邮件服务器之间发送与接收邮件（POP3仅用于终端用户代理与邮件服务器之间）。
*   **IMAP (Internet Message Access Protocol)**： #IMAP #2012年
    *   **功能**：允许用户代理从邮件服务器上**管理**和访问邮件。
    *   **特点**：
        *   **基于TCP**，使用TCP端口 **143** (或993 for IMAPS)。
        *   **"管理在服务器"模式**：邮件保留在服务器上，客户端只是访问和同步服务器上的邮件副本。
        *   **多设备同步**：非常适合在多个设备（电脑、手机）之间同步邮件状态（已读、未读、已删除、文件夹归类等）。
        *   **在线操作**：用户可以创建、删除、移动邮箱中的邮件和文件夹，这些操作都会同步到服务器。

### 3. 电子邮件格式和MIME
#电子邮件格式 #MIME #2018年
*   **邮件格式**： #邮件格式 通常遵循 #RFC822 (或更新的 #RFC5322) 标准，包含首部 (Header) 和主体 (Body)。
*   **MIME (Multipurpose Internet Mail Extensions)**： #MIME
    *   **功能**：扩展了SMTP，使其能够传输**非ASCII码数据**（如JPEG图形、MPEG视频、EXE文件、中文文本）以及多部分邮件。
    *   **工作原理**：将非ASCII码内容编码成ASCII码（如Base64编码），以便通过SMTP传输；接收方再解码还原。

## 06-5 万维网 (WWW)

### 1. 万维网核心概念
#WWW #万维网 #2014年
*   **WWW (World Wide Web)**：#全球信息网 一个由相互链接的超文本（或超媒体）文档组成的系统，通过互联网访问。
*   **URL (Uniform Resource Locator)**：#URL #统一资源定位符
    *   用于唯一标识和定位互联网上的资源（如网页、图片、文件等）。
    *   **基本格式**：`协议://主机名[:端口号]/路径[?查询参数][#片段标识符]`
        *   **协议**：用于访问资源的协议（如HTTP, HTTPS, FTP）。
        *   **主机名**：资源所在的服务器域名或IP地址。
        *   **端口号**：服务器监听的端口（HTTP默认80，HTTPS默认443，可省略）。
        *   **路径**：资源在服务器上的具体位置。
        *   **查询参数**：传递给服务器的额外参数。
        *   **片段标识符**：定位到文档内部的特定位置。
*   **HTTP (Hypertext Transfer Protocol)**：#HTTP #超文本传输协议 用于传输Web页面的应用层协议。
*   **HTML (Hypertext Markup Language)**：#HTML #超文本标记语言 用于创建Web页面的标记语言。

### 2. HTTP协议
#HTTP协议 #2015年 #2022年 #2024年 #2020年
*   **功能**：客户端（通常是Web浏览器）向Web服务器请求Web对象（如HTML文件、图片、视频等），服务器响应请求。
*   **特点**：
    *   **无状态 (Stateless)**：#无状态 服务器不保留关于过去客户端请求的任何信息。每个请求都是独立的。
        *   **优点**：简化服务器设计，易于扩展。
        *   **缺点**：无法追踪用户会话，需要通过 #Cookies 或其他机制维持会话状态。
    *   **基于TCP**：HTTP使用TCP作为其底层的传输协议，确保可靠数据传输。
    *   **端口**：HTTP默认使用TCP端口80。HTTPS默认使用TCP端口443。
    *   **相关协议**：Web访问过程可能用到多种协议，如 #PPP（点对点协议，用于ISP拨号/专线接入）， #ARP（地址解析协议，用于IP到MAC映射）， #UDP（用户数据报协议，用于DNS查询/DHCP配置）。 #SMTP（简单邮件传输协议）与Web访问**无关**。
*   **HTTP连接类型**：#HTTP连接
    *   **非持久连接 (Non-persistent HTTP)**：#非持久连接 #2024年
        *   HTTP/1.0 默认采用。
        *   每个Web对象（HTML文件、图片等）的请求和响应都建立一个独立的TCP连接。
        *   每个对象传输完毕后，TCP连接立即关闭。
        *   **缺点**：性能开销大，因为每次请求都需要TCP三次握手和四次挥手。
        *   若浏览器不支持并行TCP连接，获取 $N$ 个独立Web对象，至少需要 $2N$ RTT（每个对象包括1 RTT建立连接 + 1 RTT传输数据）。
    *   **持久连接 (Persistent HTTP)**：#持久连接 #2022年 #2015年
        *   HTTP/1.1 默认采用。
        *   客户端和服务器在一个TCP连接上发送和接收多个Web对象。
        *   连接保持打开状态，直到客户端或服务器明确关闭，或超时。
        *   **优点**：减少了TCP连接建立和关闭的开销，提高了性能，支持流水线（Pipeline）机制。
        *   结合TCP慢启动和三次握手优化（第三次握手携带HTTP请求），可以显著减少多对象获取的总RTT。
*   **HTTP报文结构**：#HTTP报文 #2015年
    *   **请求报文 (Request Message)**：客户端发送给服务器。
        *   `请求行 (Request Line)`：方法、URL、HTTP版本（如 `GET /index.html HTTP/1.1`）。
        *   `请求头部 (Request Headers)`：如Host, User-Agent, Accept, **Connection**（`Connection: close` 表示请求使用非持久连接，`Connection: keep-alive` 或省略表示请求使用持久连接）。
        *   `空行`。
        *   `请求体 (Request Body)`：POST请求中包含的数据。
    *   **响应报文 (Response Message)**：服务器发送给客户端。
        *   `状态行 (Status Line)`：HTTP版本、状态码、状态短语（如 `HTTP/1.1 200 OK`）。
        *   `响应头部 (Response Headers)`：如Server, Last-Modified, Content-Type, Content-Length, Connection。
        *   `空行`。
        *   `响应体 (Response Body)`：请求的Web对象内容。
*   **HTTP方法 (Methods)**： #HTTP方法
    *   **GET**：#GET 从服务器获取资源。**幂等**（多次执行效果相同）。
    *   **POST**：#POST 向服务器提交数据，通常用于创建新资源。**非幂等**。
    *   **HEAD**：#HEAD 请求获取资源的头部信息（如大小、类型、修改时间），不返回实际内容。**幂等**。
    *   **PUT**：#PUT 向服务器上传完整资源，通常用于更新或创建指定URI的资源。**幂等**。
    *   **DELETE**：#DELETE 删除指定URI的资源。**幂等**。
*   **HTTP状态码 (Status Codes)**： #HTTP状态码
    *   **1xx (信息)**：指示请求已接收，继续处理。
    *   **2xx (成功)**：表示请求已被成功接收、理解、接受。
        *   `200 OK`：请求成功。
    *   **3xx (重定向)**：要完成请求，需要进一步操作。
        *   `301 Moved Permanently`：永久重定向。
        *   `302 Found`：临时重定向。
        *   `304 Not Modified`：资源未修改，可以使用缓存。
    *   **4xx (客户端错误)**：请求包含语法错误或无法完成请求。
        *   `400 Bad Request`：请求语法错误。
        *   `401 Unauthorized`：未授权。
        *   `403 Forbidden`：服务器拒绝访问。
        *   `404 Not Found`：服务器找不到请求的资源。
    *   **5xx (服务器错误)**：服务器在处理请求的过程中发生了错误。
        *   `500 Internal Server Error`：服务器内部错误。
        *   `503 Service Unavailable`：服务器暂时无法处理请求。
*   **Cookies (曲奇)**： #Cookies #2015年
    *   **目的**：HTTP是无状态的，Cookies提供了一种机制来在**无状态的HTTP协议上维持会话状态**。
    *   **工作原理**：
        1.  服务器在响应浏览器请求时，通过`Set-Cookie`头部向浏览器发送Cookie。
        2.  浏览器将Cookie存储起来。
        3.  之后浏览器向同一个服务器发送请求时，会自动在`Cookie`头部带上之前存储的Cookie。
        4.  服务器通过Cookie识别用户或其会话。
    *   **应用**：用户身份认证、个性化设置、购物车等。如果请求报文中存在 `Cookie` 字段，则表明该浏览器曾经浏览过该网站。

### 3. Web缓存 (Web Caching)
#Web缓存
*   **目的**：减少网络流量、降低服务器负载、提高用户访问速度。
*   **原理**：Web缓存（通常是 #代理服务器 或浏览器缓存）存储Web对象的副本。当客户端再次请求相同的对象时，如果缓存中存在有效副本，则直接返回，而无需向原始服务器请求。
*   **分类**：
    *   **浏览器缓存 (Client Cache)**：#浏览器缓存 存储在用户本地设备上。
    *   **代理服务器缓存 (Proxy Cache)**：#代理服务器缓存 位于客户端和服务器之间，为多个用户提供缓存服务。
*   **缓存更新机制**： #缓存更新
    *   **条件GET (Conditional GET)**：客户端在请求中带上缓存对象的最后修改时间 (`If-Modified-Since`) 或实体标签 (`If-None-Match`)。服务器检查资源是否已修改：
        *   如果未修改，服务器返回 `304 Not Modified`，客户端使用缓存。
        *   如果已修改，服务器返回 `200 OK` 和新资源。
