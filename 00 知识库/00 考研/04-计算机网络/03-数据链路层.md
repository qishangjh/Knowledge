---
科目: "408"
课程名称: 计算机网络
tags: [数据链路层]
一轮复习情况: 进行中
二轮复习情况: 未开始
三轮复习情况: 未开始
难度:
考频:
备注:
---

# 03-数据链路层
Data Link Layer

> [!blank]
> - (一)[[03-数据链路层#03-1 数据链路层的功能|数据链路层的功能]]
> - (二)组帧
> - (三)差错控制 
> 	- 1.检错编码 
> 	- 2.纠错编码
> - (四)流量控制与可靠传输机制
> 	1. [[03-数据链路层#03-4 流量控制与可靠传输|流量控制、可靠传输]]与[[03-数据链路层#滑动窗口机制|滑动窗口机制]] #必考 #2020年 #2023年 #2024年
> 	2. 停止-等待协议
> 	3. 后退 N 帧协议(GBN) 
> 	4. 选择重传协议(SR)
> - (五)[[03-数据链路层#03-5 介质访问控制（MAC）技术|介质访问控制（MAC）技术]] `#必考` `#2024年` `#2025年` #必考
> 	1. 信道划分 频分多路复用、时分多路复用、波分多路复用、[[03-数据链路层#码分复用（CDM）|码分多路复用（CDM）]]的概念和基本原理。 
> 	2. 随机访问 ALOHA 协议，CSMA 协议，CSMA/CD 协议，CSMA/CA 协议。 
> 	3. 轮询访问令牌传递协议
> - (六)[[03-数据链路层#03-6 局域网|局域网]] #常考 #2024年
> 	1. 局域网的基本概念与体系结构
> 	2. 以太网与 IEEE802.3
> 	3. IEEE802.11 无线局域网
> 	4. VLAN 基本概念与基本原理 #近年新增
> - (七)广域网 #常考
> 	1. 广域网的基本概念 
> 	2. PPP 协议
> - (八)数据链路层设备 #常考
> 	- 以太网交换机及其工作原理
---

## 03-1 数据链路层的功能
- **封装成帧**：
    - 将网络层的IP数据报封装成数据链路层的**帧**（Frame）
    - **帧定界与同步**：在网络层数据报的头部和尾部添加控制信息（帧首部、帧尾部）来标识帧的开始和结束。
    - **透明传输**：确保数据帧中的任何比特组合都能被当作数据传输，而不会被误认为是帧定界符。

- **可靠传输**：
    - 确保发送方发送的帧能无差错、不丢失、不重复、按序地到达接收方。
    - **差错控制**：通过校验码（如CRC）检测帧在传输过程中是否发生比特错误。一旦检测到错误帧，接收方会丢弃，并通常会触发发送方的重传机制。
- **流量控制**：
    - 调节发送方的数据发送速率，使其与接收方的接收能力相匹配，防止接收方缓冲区溢出。主要通过**滑动窗口协议**实现。
- **介质访问控制（MAC）**：
    - 解决多个站点共享同一通信介道（信道）时，如何协调它们的发送，避免或解决冲突的问题。主要有信道划分、随机访问和轮询访问三种方式。

---
## 03-2 组帧技术

> [!key] 核心目标
> > 组帧技术的两大核心：**帧定界**（确定帧的开始和结束）和**透明传输**（确保数据内容不会被误识别为控制信息）。

### (1) 字符计数法
- **原理**：在帧首部用一个固定字段标明整个帧的字节数（包括头部和数据部分）。
- **缺点**：任何一个计数错误都会导致接收端后续所有帧的定界全部失效，难以恢复。

### (2) 字节填充法
- **原理**：使用特定的控制字符来定界帧的开始（如SOH, Start Of Header）和结束（如EOT, End Of Transmission）。为了实现透明传输，如果在数据部分出现与定界符或转义符（ESC）相同的字符，则在前面插入一个转义符（ESC）。
- **公式**：$\text{填充后帧长} = \text{原数据长度} + 2\text{（控制字符SOH/EOT）} + \text{转义符数量}$
### (3) 零比特填充法（HDLC PPP）
- **原理**：发送端扫描整个帧。当发现连续5个"1"时，立即在后面插入一个"0"。接收端接收时进行反向处理，每当发现连续5个"1"后跟着一个"0"时，就将这个"0"删除。
- **应用场景**：广泛应用于面向比特的同步传输协议，如高级数据链路控制（HDLC）和点对点协议（PPP），帧定界符通常是`01111110`（6个连续1）。
(Bit Stuffing)
> [!key] 核心原理
> 为了防止数据中的特定比特组合被误判为**帧标志字段**（如 `01111110`），保证透明传输。

-   **操作规则**：
    -   **发送端**：扫描数据，发现连续 **5个 "1"**，立即在后面插入 **1个 "0"**。
    -   **接收端**：扫描比特流，发现连续 **5个 "1"**，删除其后的 **1个 "0"**。
-   **适用协议**：HDLC（虽考纲提及删除，但零比特插入作为**透明传输机制**仍需掌握）、PPP。

> [!tip] 解题技巧 #2013年
> 扫描题目给出的比特串，从左向右，逢 5 个 `1` 必斩（后位若为 `0` 则删去，若为插入则加 `0`）。
> **注意**：不仅数据部分要填充，除了标志字段外的所有字段都要填充。
### (4) 违规编码法 （用于曼彻斯特编码）
- **原理**：利用物理层编码中本不应出现的"违规"信号来定界帧的开始和结束。
- **应用场景**：在采用曼彻斯特编码的以太网中，帧的开始和结束可以插入不符合曼彻斯特编码规则的信号（例如，在比特传输中间没有跳变），作为帧的定界标志。

---

## 03-3 差错控制编码
### 1. 检错编码
#### (1) 奇偶校验码

- **信息位**：帧的数据部分。
- **校验位**：附加的冗余比特。
    - **奇校验**：通过在数据后附加一位，使整个帧（数据+校验位）中"1"的个数为奇数。
    - **偶校验**：通过在数据后附加一位，使整个帧中"1"的个数为偶数。（**现实中更常用**，与异或运算结合方便）。
    - **异或运算**：偶校验位 $P_{\text{偶}} = D_1 \oplus D_2 \oplus \cdots \oplus D_n$。
- **特点**：只能检测**奇数位**错误，无法纠错。

#### (2) 循环冗余校验码（CRC）
#2023年 #常考
- **生成多项式** $G(x)$：
    - 如 $G(x) = x^3 + x^2 + 1$ 对应二进制`1101`。
    - **计算步骤**：
        1. 确定信息码的长度 $K$ 和生成多项式最高次幂 $R$。校验码位数 $N = K + R$。
        2. 将信息码左移 $R$ 位，低位补零。
        3. 用生成多项式对应的二进制码对左移后的信息码进行**模2除法**。
        4. 模2除法得到的**余数**即为校验位（CRC码）。将余数添加到信息码的末尾。
- **检错能力**：
    - 检测所有**奇数位**错误。
    - 检测所有**双比特**错误。
    - 检测所有连续 $\leq R$ 比特的错误。

> [!NOTE] 纠正单比特错误条件
        > 若选择合适的生成多项式，且满足 $2^R \geq K + R + 1$，则CRC码除了检错，还可以**纠正单比特错误**（尽管通常不作为主要纠错手段）。

> [!key] 计算逻辑
> 也就是**模 2 除法**（异或运算，无借位减法）。

1.  **准备**：
    -   生成多项式 $G(x)$ 阶数为 $r$，则在数据 $M$ 后面补 $r$ 个 $0$。
    -   对应二进制除数位数是 $r+1$。
2.  **运算**：
    -   数据 $\oplus$ 除数。
    -   首位为 1 商 1，首位为 0 商 0。
3.  **判定**：
    -   余数为 $0 \rightarrow$ 无错。
    -   余数非 $0 \rightarrow$ 有错，丢弃（**CRC 仅检错，不纠错**）。

| 步骤         | 操作要点                        | 计算规则                            |
| :--------- | :-------------------------- | :------------------------------ |
| **G(x)转换** | 将生成多项式 $G(x)$ 转换为二进制码字 $G$。 | $G(x)=x^4+x+1 \implies G=10011$ |
| **模2除法**   | 接收码字除以 $G$。                 | 使用**异或**运算替代减法，无借位。             |
| **验证结果**   | 检查最终余数。                     | 余数为 **0** 表示**无错误**（以极高概率）。     |
### 2. 纠错编码

#### (3) 海明校验码（纠错）
#2025年
- **设计条件**：
    - $2^k \geq n + k + 1 \quad (\text{其中 } k \text{ 为校验位数， } n \text{ 为信息位数})$
- **校验位分布**：校验位 $P_i$ 位于二进制权重为 $2^{i-1}$ 的位置（即第1、2、4、8…位）。
- **纠错步骤**：
    1. 根据校验方程计算出**伴随式**（Syndrome）。
    2. 伴随式的值指示了错误发生的**位置**。
    3. 翻转错误位，实现自动纠正。

> [!key] 核心公式 #2025年
> 设海明距离为 $d_{min}$（编码集中任意两个码字之间不同比特位的最小数量）。

| 能力 | 公式 | 说明 |
| :--- | :--- | :--- |
| **检错能力** ($e$) | $e \le d_{min} - 1$ | 检测出 $e$ 位错误 |
| **纠错能力** ($t$) | $t \le \lfloor \frac{d_{min} - 1}{2} \rfloor$ | 纠正 $t$ 位错误 |
| **同时检纠** | $e + t \le d_{min} - 1$ ($e > t$) | 检测 $e$ 位并纠正 $t$ 位 |

> [!tip] 解题步骤
> 1.  对给定的编码集，两两进行**异或**运算。
> 2.  统计异或结果中 `1` 的个数。
> 3.  **最小值**即为 $d_{min}$。
> 4.  代入公式判断选项。
---

| 概念         | 定义                                  | 计算公式                                        |
| :--------- | :---------------------------------- | :------------------------------------------ |
| **汉明距离**   | 两个码字间不同比特的数量。                       | $d(x,y)=\sum(x_i \oplus y_i)$               |
| **最小汉明距离** | 编码集中任意两码字汉明距离的最小值 $d_{\text{min}}$。 | $d_{\text{min}}=\min\{d(c_i,c_j)\}$         |
| **检错能力**   | 能检测出的最大错误比特数 $e$。                   | $e \leq d_{\text{min}}-1$                   |
| **纠错能力**   | 能纠正的最大错误比特数 $t$。                    | $t \leq \lfloor(d_{\text{min}}-1)/2\rfloor$ |
## 03-4 流量控制与可靠传输

### (1) 滑动窗口机制

- **发送窗口（ $W_T$ ）**：发送方维护的一个允许连续发送但尚未收到确认的帧序号范围。
- **接收窗口（ $W_R$ ）**：接收方维护的一个允许接收的帧序号范围（通常表示期望收到的帧）。

### (2) 协议类型
#2023年

| 协议      | 最大发送窗口 $W_{T(\max)}$ | 最大接收窗口 $W_{R(\max)}$ | 约束关系                     | 效率排序 (同 $T_D, RTT$)     |
| :------ | :------------------- | :------------------- | :----------------------- | :---------------------- |
| **S-W** | 1                    | 1                    | $1 \leq 2^n$             | $U_1$ (最低)              |
| **GBN** | $2^n - 1$            | 1                    | $W_T \leq 2^n - 1$       | $U_2$ (最高)              |
| **SR**  | $2^{n-1}$            | $2^{n-1}$            | $W_T = W_R \leq 2^{n-1}$ | $U_3$ (中等)              |
| **结论**  |                      |                      |                          | $U_1 \leq U_3 \leq U_2$ |

| **协议**         | **窗口大小**         | **帧编号位数**                  | **确认机制**  | **重传策略**       | **信道利用率 (U)**                                                   |
| :------------- | :--------------- | :------------------------- | :-------- | :------------- | :-------------------------------------------------------------- |
| **停止-等待（S-W）** | $W_T=1, W_R=1$   | 1位（0/1）                    | 单帧确认      | 超时重传当前帧        | $U = \frac{T_D}{T_D + 2RTT+T_A}$ (简化为 $\frac{T_D}{T_D + RTT}$ ) |
| **后退N帧（GBN）**  | $W_T > 1, W_R=1$ | $n \geq \log_2(W_T + W_R)$ | 累积确认      | 后退N帧（重传所有未确认帧） | $U = \frac{N \cdot T_D}{T_D + RTT}$                             |
| **选择重传（SR）**   | $W_T=W_R > 1$    | $n \geq \log_2(2W_T)$      | 单帧确认或NACK | 仅重传丢失/错误帧      | $U = \frac{N \cdot T_D}{T_D + RTT}$                             |

- **① 停止-等待协议（S-W）**
    - **核心机制**：
        - 发送方发送一帧后，必须等待并收到接收方的确认（ACK）后才能发送下一帧。
        - 发送方为每个发送的帧启动一个计时器，超时未收到ACK则重传。
    - **帧编号**：仅需1位（0或1）即可标识发送的帧。
    - **信道利用率**：$U = \frac{T_{\text{传输}}}{T_{\text{传输}} + RTT}$，其中 $RTT = 2 \times \text{单向传播时延}$。优点是实现简单，但缺点是信道利用率低。
- **② 后退N帧协议（Go-Back-N，GBN）**
    - **窗口大小**：发送窗口 $W_T > 1$表示它可以连续发送的帧的序号范围，只有窗口最左边的帧被确认后，整个窗口才能向前滑动；接收窗口 $W_R = 1$，只接受期望的、序号最小的帧。
    - **确认机制**：累计确认（Cumulative ACK）。接收方只接受按序到达的帧。它采用**累积确认**机制，即一个ACK帧表示已正确接收到该序号之前（包含该序号）的所有帧。
    - **异常处理**：若发送方超时，或者接收方检测到帧错误/失序，它会丢弃所有超出接收窗口的帧，并反复发送它期望收到的那个帧的ACK。发送方收到重复ACK或超时后，会**重传该帧及后续所有已发送但未被确认的帧**（"后退N帧"）。
- **③ 选择重传协议（SR）**
    - **特点**：
        - **不支持累积确认**，必须**一帧一确认**（每个正确接收的帧都发送一个独立的ACK）。
        - 接收窗口 $W_R$ 可以大于1，允许接收方**缓存非连续到达的正确帧**。
        - 发送方只重传**丢失或出错的特定帧**，而不是所有后续帧。
    - **确认机制**：接收方收到正确帧后，返回确认帧ACK_i。若收到错误帧，返回否认帧NAK_i，请求重传。
    - **帧编号**：至少需要 $n$ 比特给帧编号，需满足 $W_T + W_R \leq 2^n$。
    - **窗口大小关系**：为了避免歧义，通常要求 $W_T = W_R$，且必须满足 $W_T \leq 2^{n-1}$（即 $W_T + W_R \leq 2^n$）。
- **误区与注意事项**
    - **GBN与SR的窗口限制**：GBN满足 $W_T + W_R \leq 2^n$；SR除了满足此条件外，通常要求 $W_T = W_R \leq 2^{n-1}$。
    - **帧序号连续性**：GBN接收方必须按序接收，并丢弃失序帧；SR接收方允许缓存非连续帧，等待前面的帧到达后按序递交给上层。
    - **信道利用率上限**：当 $N \cdot T_D \geq RTT$ 时，理论上信道利用率 $U_{\text{理想}} \approx 100\%$。
- **总结与应用场景**
    - **S-W**：实现简单，适用于低速、低延迟、传输错误率低的场景。
    - **GBN**：在传输错误率较低但需要较高吞吐量的高速信道中表现良好，但重传开销相对较大。
    - **SR**：在传输错误率较高或信道延迟较大的场景（如卫星通信）中表现最优，因为它能避免不必要的重传，但实现复杂。
- **扩展知识点**
    - **ARQ协议**：自动重传请求协议，是上述三种协议的统称，它们都利用确认和超时机制来实现可靠传输。
    - **连续ARQ协议**：指GBN和SR这类允许连续发送多帧而无需等待每个ACK的协议。

### 信道利用率计算

| 场景         | 公式                                             | 变量含义                                           | 考查要点                                              |
| :--------- | :--------------------------------------------- | :--------------------------------------------- | :------------------------------------------------ |
| **通用利用率**  | $U = \frac{N \cdot T_D}{T_{\text{周期}}}$        | $T_D$: 单帧传输时延; $T_{\text{周期}}$: 发送 $N$ 帧所需总时间。 | 必须准确计算 $T_D, T_{\text{周期}}$，注意单位换算。 #2018年 #2020年 |
| **S-W 协议** | $U = \frac{T_D}{T_D + 2T_{\text{传播}}}$         | 忽略确认帧时延 $T_A \approx 0$。                       | 重点考查停等协议的低效性。                                     |
| **最小序号位数** | $n \geq \lceil \log_2(W_{T(\min)} + 1) \rceil$ | $W_{T(\min)}$: 为满足 $U_{\text{要求}}$ 的最小窗口。      | 结合利用率计算出 $W_{T(\min)}$ 后，再确定 $n$。 #2015年          |

---

## 03-5 介质访问控制（MAC）技术

**介质访问控制 (MAC)**：解决多个节点共享同一个总线型广播信道时，如何协调它们发送数据，以避免或解决信号冲突的问题。
主要有三种方式：信道划分、随机访问和轮询访问。
### (1) 信道划分方法

> [!NOTE] 信道划分的特点
> 这类方法在发送前就预先分配好信道，因此是**静态的**，**无冲突**的，但当负载较轻时，信道利用率可能较低。

| **技术**              | **原理**                                       | **优缺点**                                | **适用场景**           |
| :-------------------- | :--------------------------------------------- | :---------------------------------------- | :--------------------- |
| **时分复用（TDM）**    | 将时间划分为固定长度的时隙，分配给不同节点。   | 优点：无冲突；缺点：固定分配导致利用率低。 | 电话系统、早期局域网。 |
| **统计时分复用（STDM）** | 动态按需分配时隙，提升利用率。                 | 优点：利用率高；缺点：需复杂调度。        | 高速数据通信。         |
| **频分复用（FDM）**    | 将信道频带划分为子频带，每个节点占用独立频段。 | 优点：并行传输；缺点：仅适用于模拟信号。  | 广播电视、多路音频传输。 |
| **波分复用（WDM）**    | 光信号的频分复用，通过不同波长划分子信道。     | 优点：超高带宽；缺点：需光设备支持。      | 光纤骨干网。           |
| **码分复用（CDM）**    | 使用正交码片序列区分节点信号，允许叠加传输。   | 优点：抗干扰强；缺点：需复杂编码和解码。  | 移动通信（如CDMA）。   |

#### 码分复用（CDM）
- **原理**：使用正交的**码片序列**进行编码，允许所有用户在同一时间、同一频率上发送数据。
- **解码**：通过接收序列与目标站点的码片序列进行**内积运算**实现信号分离。
- **发送比特**：数据比特 $1 \implies$ 发送码片 $S$；数据比特 $0 \implies$ 发送码片 $-S$。

| 步骤       | 操作要点                                     | 关键公式                                                                                 |
| :------- | :--------------------------------------- | :----------------------------------------------------------------------------------- |
| **序列分组** | 接收序列按码片长度 $L$ 分割。                        | $L = \text{码片序列长度}$                                                                  |
| **内积计算** | 接收序列分组 $R_i$ 与目标码片 $S_{\text{目标}}$ 进行内积。 | $\text{内积} = R_i \cdot S_{\text{目标}} = \sum_{j=1}^{L} R_{i,j} \cdot S_{\text{目标},j}$ |
| **解码判定** | 内积结果除以 $L$。                              | 结果 $>0 \implies$ 比特 1； 结果 $<0 \implies$ 比特 0； 结果 $=0 \implies$ 无数据。                  |
### (2) 随机访问协议

> [!NOTE] 随机访问的特点
> 这类协议不预先分配信道，而是让所有节点"平等竞争"，通常会伴随冲突和冲突解决机制。

- **ALOHA 协议**
    - **① 纯ALOHA**
        - **特点**：节点准备好数据帧后**立即发送**，不监听信道，不考虑其他节点是否在发送。
        - **冲突处理**：如果两个节点同时发送，则发生冲突。接收方收到错误信息后不返回ACK。发送方设置超时计时器，超时未收到ACK则随机等待一段时间后重传。
        - **缺点**：冲突概率高，信道利用率最低（理论最大约18%）。
    - **② 时隙ALOHA**
        - **特点**：将时间切分为固定大小的时隙。节点只能在**时隙开始时**发送数据帧。
        - **优点**：减少了发送的随意性，降低了冲突概率，提高了信道利用率（理论最大约31.6%）。
        - **重传机制**：发生冲突后，节点随机等待一段时间后再尝试重传。
- **CSMA 协议**
    - **发展**：在ALOHA协议基础上加入**载波监听机制**（Carrier Sense），即发送前先监听信道。
    - **分类**：
        - **① 1-坚持CSMA**
            - **定义**：发送数据前监听信道。若信道**空闲则立即发送**。若信道**忙则坚持监听**，直到信道空闲立即发送。
            - **优点**：信道利用率高。
            - **缺点**：当多个节点同时准备好数据时，信道一旦空闲，它们会**同时竞争发送**，导致冲突概率大。
        - **② 非坚持CSMA**
            - **定义**：发送数据前监听信道。若信道**空闲则立即发送**。若信道**忙则放弃监听**，随机推迟一段时间后再尝试监听。
            - **优点**：通过随机推迟降低了冲突概率。
            - **缺点**：可能导致信道利用率降低，因为信道刚空闲时可能不会被立即使用。
        - **③ P-坚持CSMA**
            - **定义**：发送数据前监听信道。若信道**忙则坚持监听**。若信道**空闲**，则以**概率 P 立即发送**数据帧，以**概率 (1-P) 推迟一个时隙**再监听。
            - **优点**：是1-坚持CSMA和非坚持CSMA的折中方案，平衡了冲突概率与信道利用率。
- **CSMA/CD 与 CSMA/CA 协议**
    - **CSMA/CD 协议**：用于**早期有线以太网**（总线型拓扑，集线器连接的以太网）。
    - **CSMA/CA 协议**：用于 **IEEE 802.11 无线局域网**（Wi-Fi）。
    - **考研重点**：CSMA/CD 最常考，其次是CSMA/CA。

**CSMA/CD (Carrier Sense Multiple Access with Collision Detection)**：带冲突检测的**载波监听多点接入**。这是早期以太网中，多个设备共享一条传输介质（比如一根电缆）时，用来协调数据发送和处理冲突的规则。
- **核心机制**：
    - **载波监听** (Carrier Sense)：发送前监听信道是否空闲。
    - **多点接入** (Multiple Access)：所有站点共享信道。
    - **冲突检测** (Collision Detection)：在发送过程中持续监听，**边发送边检测**是否有冲突发生。
    - **争用期（Collision Window）**：为了确保冲突能被检测到，最坏情况下冲突信号需从网络一端传播到另一端再返回。
        - $\text{争用期} = 2 \times \text{最大单向传播时延}$。
    - **最短帧长**：为了确保发送方在发送完整个帧之前能检测到可能发生的冲突。（如果一个站点发送的数据帧**太短**，它可能在自己的信号还没有到达最远端站点，以及最远端站点可能产生的冲突信号还没有传回来之前，就已经把整个帧发送完了！如果它已经发送完了，就不再监听介质了，那么它就**无法检测到可能发生的冲突**，会误以为数据发送成功。这会导致数据丢失和网络混乱。）
        - $\text{最短帧长} = 2 \times \text{带宽} \times \text{最大单向传播时延}$。 
    - **最长帧长**：以太网标准通常为1500字节，防止过长帧占用信道过久或导致交换机缓存溢出。
- **应用场景**：传统总线型局域网（如集线器连接的以太网）。**半双工模式**下需要CSMA/CD，**全双工模式**下无需CSMA/CD。

#### CSMA/CD (Carrier Sense Multiple Access with Collision Detection)
- **应用场景**：有线共享式以太网（半双工）。
- **核心机制**：**先听后说**（载波监听）、**边听边说**（冲突检测）。
- **争用期** $2\tau$：网络中最大的往返传播时延。
- **最小帧长** $L_{\text{min}}$：为确保冲突能被检测到，帧传输时间 $T_D$ 必须大于等于争用期 $2\tau$。
    $$L_{\text{min}} = C \times 2\tau = C \times 2 \times \frac{s_{\max}}{v}$$
    - $C$: 传输速率； $s_{\max}$: 最大网络直径； $v$: 传播速度。

#### 关键答题技巧：最小帧长与退避算法 `#常考` `#2019年` `#2025年`

| 步骤 | 操作要点 | 关键公式/规则 | 考查方向 |
| :--- | :--- | :--- | :--- |
| **最小帧长计算** | 计算单向时延 $\tau$ 或争用期 $2\tau$。 | $2\tau = \frac{L_{\text{min}}}{C}$ 或 $\tau = \frac{L_{\text{min}}}{2C}$ | 根据速率和帧长求最大距离/时延。 `#2019年` |
| **二进制指数退避** | 确定退避指数 $k$ 和随机范围 $r$。 | $k = \min(\text{冲突次数 } n, 10)$； $r \in [0, 2^k - 1]$。 | 求最大等待时间 $r_{\max} \times 51.2 \mu s$。 `#2025年` |
| **变化量分析** | 最小帧长与网络直径成正比。 | $\Delta s = \frac{\Delta L \times v}{2C}$ | 帧长变化对网络直径的影响。 `#2009年` |

#### CSMA/CA (Carrier Sense Multiple Access with Collision Avoidance)
- **应用场景**：无线局域网 IEEE 802.11 (Wi-Fi)。
- **核心机制**：**冲突避免**（无法有效检测冲突）、**ACK 确认**机制。
- **信道预约**：通过**RTS/CTS**（请求发送/清除发送）帧交换，解决**隐藏终端**问题。 `#2018年`
- **NAV (网络分配矢量)**：虚拟载波监听机制。站点通过接收到的RTS/CTS帧中的持续时间信息，设置NAV，在此期间不发送数据。

#### 关键答题技巧：CSMA/CA与NAV计算 `#2024年`

| 步骤             | 操作要点                             | 关键公式/规则                                                                             | 考查方向                                       |
| :------------- | :------------------------------- | :---------------------------------------------------------------------------------- | :----------------------------------------- |
| **数据帧时延**      | 准确计算待传输数据帧的时延 $T_{\text{DATA}}$。 | $T_{\text{DATA}} = \frac{L_{\text{数据}} \times 8}{C}$                                | 确保单位一致（$\mu s$）。                           |
| **NAV设置（CTS）** | 隐藏站收到 CTS 帧时，设置 NAV 的持续时间。       | $\text{NAV} = T_{\text{SIFS}} + T_{\text{DATA}} + T_{\text{SIFS}} + T_{\text{ACK}}$ | 预约时间从数据帧开始传输算起。 `#2024年`                   |
| **IFS优先级**     | 根据帧类型选择正确的帧间间隔。                  | $T_{\text{SIFS}} < T_{\text{PIFS}} < T_{\text{DIFS}}$                               | SIFS 用于控制帧（最高优先级），DIFS 用于数据帧（竞争）。 `#2020年` |

- 
---

## 03-6 局域网
-   **个人区域网络 (PAN - Personal Area Network)**：就像你身体周围的电子设备之间搭建的"私密小圈子"，范围极小。
-   **局域网 (LAN - Local Area Network)**：就像你家、办公室或学校教学楼的内部地图，范围较小，通常由个人或组织拥有。
-   **城域网 (MAN - Metropolitan Area Network)**：就像一个城市的地图，连接着城市里多个局域网，通常由电信运营商或大型企业管理。
-   **广域网 (WAN - Wide Area Network)**：就像一个国家甚至全球的地图，连接着相距遥远的不同城市和区域，是最大的网络。

| 特性            | **广域网 (WAN)**                                 | **城域网 (MAN)**                   | **局域网 (LAN)**                       | **个人区域网 (PAN)**                    |
| :------------ | :-------------------------------------------- | :------------------------------ | :---------------------------------- | :--------------------------------- |
| **地理范围**      | 覆盖范围最大，跨越城市、国家甚至全球。                           | 覆盖一个城市或一个大的地理区域（如大型企业园区）。       | 较小，一个建筑物内、家庭内、办公室或校园。               | 极小，围绕个人（几厘米到十几米）。                  |
| **距离**        | 几十公里到几千公里甚至更远。                                | 几公里到几十公里。                       | 几十米到几公里。                            | 几厘米到十几米。                           |
| **拓扑结构**      | 复杂，通常是网状结构，由路由器互联而成。                          | 通常是混合拓扑，常以环形或总线形主干连接多个 LAN。     | 星形、总线形、环形、混合型（现代多为星形或无线网状）。         | 点对点（如蓝牙配对）、星形（以个人设备为中心）。           |
| **传输介质**      | 光纤、卫星通信、微波、专用租用线路。                            | 光纤是主要介质，也可能使用同轴电缆或微波。           | 双绞线（网线）、光纤、无线电波（Wi-Fi）。             | 蓝牙 (无线)、红外 (无线)、NFC (无线)、USB (有线)。 |
| **数据速率 (带宽)** | **相对较低**，Kbps 到 Gbps，速率受距离和线路限制，接入成本高。        | **中等至高**，通常 100Mbps 到数 Gbps。    | **高**，通常 100Mbps、1Gbps、10Gbps 甚至更高。 | **低至中等**，通常 Kbps 到 Mbps 级别（如蓝牙）。   |
| **所有权与管理**    | 通常由**电信运营商、ISP**拥有和管理，用户租用服务。                 | 通常由大型企业、政府或**电信运营商**拥有和管理。      | **私有**，由个人或组织拥有和管理。                 | 个人拥有和管理。                           |
| **设备**        | 路由器、调制解调器、CSU/DSU、大型交换机。                      | 路由器、交换机、光纤收发器、多路复用器。            | 网卡、集线器、交换机、路由器、无线接入点 (AP)。          | 智能手机、笔记本电脑、平板电脑、智能手表、耳机、鼠标、键盘。     |
| **协议**        | TCP/IP、MPLS、SD-WAN、帧中继 (Frame Relay)、ATM（较老）。 | Ethernet（用于城域以太网）、MPLS、ATM（较老）。 | 以太网 (Ethernet) 是主流，Wi-Fi (802.11)。  | 蓝牙协议栈 (Bluetooth), 红外协议, NFC协议。    |
| **典型应用**      | 互联网、跨国公司分支机构互联、云服务访问、远程办公。                    | 城市内银行分支机构互联、有线电视网络、大型大学校区互联。    | 家庭文件共享、办公室内部通信、校园网。                 | 手机与耳机连接、设备同步、智能穿戴、移动支付。            |
| **成本**        | 较高。                                           | 中等。                             | 较低。                                 | 极低（通常设备集成）。                        |
| **小比喻**       | 全国乃至全球范围的沟通。                                  | 城市内部的沟通。                        | 家庭或办公室内部的沟通。                        | 你的身体周围的电子设备之间的小对话。                 |


---

### 1. 局域网的基本概念和体系结构

-   **特殊的局域网拓扑实现**：

| 技术                          | 逻辑拓扑结构 | 物理拓扑结构 |
| :---------------------------- | :----------- | :----------- |
| 以太网 (Ethernet, IEEE 802.3) | 总线型       | 星型         |
| 令牌环 (Token Ring, IEEE 802.5) | 环形         | 星型         |
| FDDI (光纤分布数字接口, IEEE 802.5) | 环形         | 双环         |

-   **IEEE 802标准对应的局域网参考模型**：
    IEEE 802标准族主要对应 OSI 参考模型的**数据链路层**和**物理层**。为了更好地适应局域网的特性，数据链路层被进一步划分为两个子层：
    -   **逻辑链路控制 (LLC) 子层 (IEEE 802.2)**：
        -   位于数据链路层上部，提供与**网络层**的接口服务。
        -   负责数据链路层的**流量控制**和**差错控制**（针对数据帧本身）。
        -   其设计目标是**与传输介质无关**，向上层提供统一的数据链路服务。
    -   **介质访问控制 (MAC) 子层**：
        -   位于数据链路层下部，控制对**共享物理介质**的访问。
        -   负责**数据帧的封装/解封装**、**物理地址（MAC地址）寻址**、**介质访问竞争机制**（如 CSMA/CD, CSMA/CA）以及**比特传输差错检测**。
        -   其设计目标是**与传输介质密切相关**，不同介质有不同的 MAC 协议。

### **2 以太网 (IEEE 802.3)**
目前最流行、应用最广泛的有线局域网技术。DIX Ethernet V2 标准与 IEEE 802.3 标准基本兼容。

1.  **以太网的传输介质与网卡**
    -   **传输介质**：主要使用**双绞线**（如 Cat5e, Cat6 等，通过 RJ45 连接器连接）和**光纤**（用于高速率或远距离传输）。早期也使用过同轴电缆。
    -   **网卡 (Network Interface Card, NIC)**：实现 MAC 层和物理层的功能，每个网卡都固化了一个全球唯一的 MAC 地址。

2.  **以太网的 MAC 地址**
    -   **MAC 地址**：又称物理地址、硬件地址，是一个 **48 位（6 字节）** 的全球唯一标识符。
    -   **作用**：用于在局域网内进行物理寻址，数据帧通过 MAC 地址在同一广播域内找到目标设备。
    -   **格式**：通常用 `:` 或 `-` 分隔的 12 位十六进制数字表示，如 `00:0A:E6:3E:C5:10`。

3.  **以太网的 MAC 帧结构** (以太网 V2 / DIX 以太网帧为例)

| **字段**          | **长度**       | **描述**                                                                  |
| :---------------- | :------------- | :------------------------------------------------------------------------ |
| **前导码 (Preamble)** | 7 字节         | `10101010…` 比特序列，用于接收方时钟同步。                                |
| **帧开始定界符 (SFD)** | 1 字节         | `10101011` 比特序列，表示帧的开始。                                        |
| **目的 MAC 地址**   | 6 字节         | 目标设备的物理地址（全 1 为广播地址，特定多播地址为组播地址）。          |
| **源 MAC 地址**     | 6 字节         | 发送设备的物理地址。                                                     |
| **类型字段**      | 2 字节         | 标识上层协议（如 `0x0800` 为 IP 协议，`0x0806` 为 ARP 协议）。             |
| **数据**          | **46 ~ 1500 字节** | 承载网络层数据（IP 数据报等）。如果数据长度不足 46 字节，需要填充补齐。 |
| **FCS (帧校验序列)**  | 4 字节         | CRC 循环冗余校验码，用于检测帧在传输过程中是否发生错误。                   |

-   **帧长度**：不包含前导码和 SFD，以太网帧的最小长度是 64 字节（如果数据小于 46 字节，需要填充），最大长度是 1518 字节。


4.  **高速以太网**
    以太网技术不断发展，以满足更高的带宽需求：
    -   **快速以太网 (Fast Ethernet)**：`100 Mbps`。
    -   **千兆以太网 (Gigabit Ethernet)**：`1 Gbps`。
    -   **万兆以太网 (10 Gigabit Ethernet)**：`10 Gbps`。
    -   以及 `40 Gbps`、`100 Gbps` 甚至更高速率的以太网。

### **3. 无线局域网 (IEEE 802.11)**
即 Wi-Fi 技术，使用无线电波作为传输介质。

1.  **核心概念**

| **术语**           | **描述**                                                                                                        |
| :----------------- | :-------------------------------------------------------------------------------------------------------------- |
| **AP (接入点)**    | Access Point，无线网络的中心枢纽，提供无线（802.11）与有线（802.3）网络的桥接，负责无线终端的接入和认证。         |
| **STA (站点)**     | Station，指无线局域网中的任何一个无线终端设备，如笔记本电脑、智能手机等。                                      |
| **BSS (基本服务集)** | Basic Service Set，由 **1 个 AP** 和与其关联的**多个 STA** 组成的无线网络，是无线网络的基本单元。                 |
| **ESS (扩展服务集)** | Extended Service Set，由**多个 BSS** 通过**分配系统 (DS)**（通常是有线网络）互联而成，提供更广阔的无线覆盖和**漫游**功能。 |
| **SSID**           | Service Set Identifier，无线网络的名称（如"TP-LINK-XXXX"），用于标识一个 BSS 或 ESS。                         |
| **漫游 (Roaming)** | 移动终端在 ESS 内，从一个 AP 的覆盖范围移动到另一个 AP，但**连接保持不中断**，实现无缝切换。                     |

2.  **CSMA/CA 协议** (Carrier Sense Multiple Access with Collision Avoidance)
    -   **核心机制**：**冲突避免**（Avoidance）。与有线以太网的 CSMA/CD 不同，无线信道难以有效检测冲突（无法同时收发），因此采用预防性措施来**避免冲突**。
    -   **预约信道 (RTS/CTS)**：
        -   **RTS (Request To Send)**：发送方在发送数据前，先向 AP 发送 RTS 帧，请求信道使用权，并声明将要占用信道的时间长度。
        -   **CTS (Clear To Send)**：AP 收到 RTS 后，如果信道空闲，回应 CTS 帧，批准发送，并通告所有其他监听站台在指定时间内不要发送数据。这有助于解决**隐藏站问题**（信道监听范围有限，某些站之间互不感知，但它们都与 AP 通信）。
    -   **帧间间隔 (IFS - InterFrame Space)**：通过设置不同长度的帧间间隔，实现对信道访问的优先级控制。
        -   **SIFS (Short IFS)**：最短，用于紧急响应帧（如 ACK 帧、CTS 帧、碎片重传帧），具有最高优先级。
        -   **DIFS (Distributed IFS)**：较长，用于竞争信道发送数据帧（通常的数据帧）。
        -   **PIFS (PCF IFS)**：介于 SIFS 和 DIFS 之间，用于 PCF (点协调功能) 下的高优先级帧。
    -   **NAV (Network Allocation Vector)**：通过 RTS/CTS 帧中的"持续时间"字段，所有监听站点都会设置一个 NAV 计时器，在此时间内信道被认为是忙的，从而实现"虚拟载波监听"，避免冲突。

3.  **802.11 帧格式** (与有线以太网帧格式有显著区别)

| **字段**       | **长度** | **描述**                                                                                                                                                                                                                                                                                            |
| :------------- | :------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **帧控制**     | 2 字节   | 包含协议版本、类型（数据帧/控制帧/管理帧）、子类型（如 ACK、RTS、CTS）、To DS/From DS（指示帧是否发往/来自分配系统，从而决定地址字段的使用）、更多分片、重传等，非常复杂，是区分帧类型和处理方式的关键。                                                                                                       |
| **持续时间/ID** | 2 字节   | 在数据帧和控制帧中表示**网络分配矢量 (NAV)**，声明后续帧将占用信道的时间长度，以便其他站在此期间不进行发送以避免冲突。在某些管理帧中，此字段可用作 ID。                                                                                                                                                  |
| **地址1**      | 6 字节   | 通常是**接收方 MAC 地址**。在某些帧中，也可以是 AP 的 MAC 地址。                                                                                                                                                                                                                                    |
| **地址2**      | 6 字节   | 通常是**发送方 MAC 地址**。在某些帧中，也可以是 AP 的 MAC 地址。                                                                                                                                                                                                                                    |
| **地址3**      | 6 字节   | 仅在某些帧类型（如穿越 DS 的帧）中出现，用于识别**源 BSSID** (发送方所属 AP 的 MAC 地址) 或**目的 BSSID** (接收方所属 AP 的 MAC 地址)。在复杂的 ESS 网络中，此字段至关重要。                                                                                                                            |
| **序列控制**   | 2 字节   | 包含**序列号**和**分片号**。序列号用于对数据帧进行编号，以便接收方能正确重组分片和检测重复帧；分片号用于标识同一数据帧的不同分片。                                                                                                                                                              |
| **地址4**      | 6 字节   | 仅在无线分布式系统 (WDS) 或 Mesh 网络中出现，当帧从一个 AP 转发到另一个 AP 时，用于标识**原始的发送方 MAC 地址**或**最终的目的方 MAC 地址**。                                                                                                                                                 |
| **数据**       | 0~2312 字节 | 实际传输的数据负载。                                                                                                                                                                                                                                                                                    |
| **FCS**        | 4 字节   | 帧校验序列（CRC），用于错误检测。                                                                                                                                                                                                                                                                   |

### **4. VLAN (虚拟局域网)**
-   **定义**：VLAN 是一种将一个**物理局域网在逻辑上划分为多个广播域**的技术。每个 VLAN 内部的成员主机可以像在独立局域网中一样通信，而不同 VLAN 之间的主机默认是相互隔离的，除非通过路由器（三层设备）进行互联。
-   **优点**：
    -   **提高安全性**：隔离广播域，限制广播风暴。
    -   **灵活管理**：不受物理位置限制，可按部门、项目等逻辑进行分组。
    -   **降低成本**：减少物理布线和路由器数量。

1.  **VLAN 划分方式**

| **类型**           | **实现方式**                                     | **优点/适用场景**                                       |
| :----------------- | :----------------------------------------------- | :-------------------------------------------------------- |
| **基于端口 (Port-based)** | 根据交换机端口分配 VLAN ID (VID)。               | **最常见、最简单**。适用于设备位置相对固定、部门划分明确的场景。 |
| **基于 MAC 地址**    | 根据终端设备的 MAC 地址动态划分 VLAN。           | 适用于用户移动性强、设备经常变动的场景。管理较为复杂。    |
| **基于 IP 地址/协议** | 根据终端的 IP 地址段或上层协议类型划分 VLAN。    | 适用于跨交换机的逻辑分组，需要三层交换机或路由器支持。    |
| **基于认证 (802.1X)** | 用户通过认证后动态分配到特定 VLAN。            | 适用于高安全要求、访客网络等场景。                        |

2.  **802.1Q 帧结构**：
    为了在支持 VLAN 的设备（如交换机）之间传输带有 VLAN 信息的帧，IEEE 802.1Q 标准在标准以太网帧中**插入了一个 4 字节的 VLAN 标签**。

```
    标准以太网帧结构：| 目的MAC | 源MAC | 类型字段 | 数据 | FCS |
    ↓↓ 插入 VLAN 标签 ↓↓
    802.1Q 帧结构：  | 目的MAC | 源MAC | TPID    | TCI        | 类型字段 | 数据 | FCS |
                       (2字节)   (2字节)
```
- ?
    -   **TPID (Tag Protocol Identifier)**：2 字节，固定值为 `0x8100`。这个值标识着紧随其后的是一个 802.1Q 标签，允许不支持 VLAN 的设备忽略此标签。
    -   **TCI (Tag Control Information)**：2 字节，包含：
        -   **优先级 (Priority)**：3 位，用于指示帧的服务质量 (QoS) 优先级，可用于流量管理。
        -   **CFI (Canonical Format Indicator)**：1 位，用于兼容以太网和令牌环网之间的帧格式。
        -   **VID (VLAN ID)**：12 位，用于唯一标识帧所属的 VLAN。可表示 `0` 到 `4095` 个 VLAN (0 和 4095 通常保留)。

3.  **干线链路 (Trunk Link)**：
    -   干线链路是用于连接**支持 VLAN 的交换机之间**，或者连接**交换机和路由器**的物理链路。
    -   它的作用是允许**承载多个 VLAN 的流量**。在干线链路上，数据帧会被打上 802.1Q 标签（Tag），通过标签中的 VID 来区分不同 VLAN 的流量。
    -   这样，不同 VLAN 的流量可以在同一条物理链路上逻辑分离地传输，实现了资源的复用。

### 以太网 (IEEE 802.3)
- **服务特性**：提供**无连接不可靠服务**。可靠性由上层协议（如TCP）保证。 `#2012年`
- **MAC帧最小长度**：64字节（512比特），由CSMA/CD的争用期决定。

### 无线局域网 (IEEE 802.11)
- **BSS**：基本服务集，1个AP + 多个STA。
- **ESS**：扩展服务集，多个BSS通过DS（有线网络）互联。
- **802.11 帧地址**：取决于帧流向（To DS/From DS位）。
    - **上行（STA $\to$ AP $\to$ R）**：
        - `地址1`（接收方）：AP的MAC。
        - `地址2`（发送方）：STA的MAC。
        - `地址3`（目的过滤）：路由器的MAC。 `#2017年`

### VLAN (虚拟局域网)
- **核心功能**：**逻辑上分割广播域**。同VLAN内二层通信，跨VLAN通信需三层设备。
- **ARP表项**：主机ARP表中只会记录**同一VLAN（同一广播域）**内其他主机的IP-MAC映射。不同VLAN的主机无法通过ARP发现彼此。 `#2024年`
- **802.1Q 标签**：在标准以太网帧中插入4字节标签，包含12位VID（VLAN ID）用于标识所属VLAN。

---

## 03-7 以太网交换机

### 1. 以太网交换机基础

- **定义**：以太网交换机是**多端口的网桥**，工作在**数据链路层**。它通过**学习MAC地址**实现数据帧在不同端口之间的高效转发。
- **作用**：替代集线器（Hub），每个交换机端口都是一个独立的**冲突域**，大大减少了冲突的发生，提升了网络性能。

- **工作层次**：数据链路层（L2）。
- **转发依据**：数据帧中的**目的物理地址**（MAC地址）。 #2009年
- **冲突域与广播域**：交换机能分割**冲突域**（每个端口都是一个独立的冲突域），但**不分割广播域**（广播帧泛洪）。 #2020年
### 2. 交换机的自学习功能

- **机制**：根据接收帧的**源MAC地址**和**入端口**建立或更新转发表项。
- **转发策略**：
    1. **自学习**：记录源MAC地址。
    2. **过滤/转发**：根据目的MAC地址查表。
    3. **泛洪**：目的MAC未知或为广播地址时，向除入端口外的所有端口转发。 #2014年
    4. 
- **交换表机制**：每个交换机都维护一张**MAC地址表**（或称为**转发/过滤表**），记录了MAC地址与端口的映射关系。
- **学习过程**：
    1. 当交换机从某个端口接收到数据帧时，它会读取帧的**源MAC地址**。
    2. 如果该源MAC地址不在交换表中，交换机就会**学习**它，将源MAC地址与接收该帧的端口号进行绑定，并记录在交换表中。
    3. 然后，交换机读取帧的**目的MAC地址**。
        - 如果目的MAC地址**存在于交换表**中，且对应端口不是接收帧的端口，交换机就将帧**直接转发**到对应的出端口。
        - 如果目的MAC地址**不存在于交换表**中，或者目的MAC地址是**广播/组播地址**，交换机就会将帧**向除接收端口外的所有其他端口广播**（称为**泛洪，flooding**）。
        - 如果目的MAC地址对应端口就是接收帧的端口，交换机则会**丢弃**该帧。
- **示例拓扑与帧传输分析**：(结合你提供的例子进行思考)
    - **A→C**：交换机1学习 `A->端口1`。C地址未知，交换机1泛洪。
    - **B→C**：交换机1学习 `B->端口2`。C地址未知，交换机1泛洪。
    - **C→A**：交换机2学习 `C->C所在端口`。交换机2知道A在交换机1方向，转发给交换机1。交换机1知道A在端口1，直接转发给A。
    - **H→A**：交换机1学习 `H->H所在端口`。A地址已知，交换机1直接转发。
    - **J→广播**：广播帧会泛洪到所有连接的设备。
    - 通过这样的动态学习，交换机能够逐渐构建起完整的MAC地址表，实现高效的"一对一"转发。

### 3. 交换表过期与问题处理

- **问题**：如果一个节点从一个端口断开，连接到另一个端口，而交换表中的旧记录没有及时更新，就会导致数据被转发到错误的端口。
- **解决方案**：交换表中的每个表项都设置一个**有效期（老化时间）**，通常为几分钟。如果在有效期内没有再次收到该MAC地址发出的帧，该表项就会自动删除。当节点H移动到新端口并再次发送帧时，交换机会学习并更新其新端口的记录。

### 4. 交换机的两种转发方式

| **类型**   | **直通交换（Cut-Through Switching）** | **存储转发（Store-and-Forward）**     |
| :------- | :------------------------------ | :------------------------------ |
| **原理**   | 接收帧的**目的地址**部分（前6字节）后立即转发。      | 接收**完整帧**，校验无误后再转发。             |
| 转发时机     | 接收目的MAC地址（前6B/48bit）            | 接收整个帧后。                         |
| 最小延迟     | $T_{\min} = \frac{48}{C}$       | $T_{\min} = \frac{L_{\min}}{C}$ |
| **优点**   | 时延极低（只需接收目的地址所需时间）。             | 可检测帧错误，进行CRC校验，支持速率匹配和协议转换。     |
| **缺点**   | 无法检测帧CRC错误，会将错误帧转发出去。 #2013年    | 时延高，需要缓存支持。                     |
| **适用场景** | 高速、低延迟需求的同速率网络。                 | 需要错误检测、速率转换的异构网络。               |
- **例题计算**：直通交换接收48bit目的地址所需时间？
    - $\text{时间} = \frac{\text{数据量}}{\text{带宽}} = \frac{48 \text{ bit}}{100 \text{ Mbps}} = \frac{48}{100 \times 10^6} \text{ s} = 0.48 \mu\text{s}$。

---

## 03-8. 广域网（WAN）

> [!NOTE] 考频极低
> 考研大纲在数据链路层部分对广域网的要求内容较少，考频极低。主要可能涉及广域网的基本定义、特点、与局域网的区别，以及点对点协议（PPP）、高级数据链路控制（HDLC）等基本概念。

- **广域网**：通常覆盖范围广（城市、国家、全球），传输距离远，数据传输速率相对较低（相对于LAN），由路由器连接。
- **点对点协议（PPP）**：在广域网中广泛使用的，用于在点对点链路上传输IP数据报的协议。它提供链路控制协议（LCP）和网络控制协议（NCP），支持身份验证和多种网络协议。
- **高级数据链路控制（HDLC）**：一种面向比特的同步数据链路层协议，广泛应用于广域网中。

### 点对点协议（PPP）
- **特点**：用于在点对点链路上传输IP数据报。
- **帧定界**：使用**零比特填充**实现透明传输。
- **功能**：提供链路控制协议（LCP）和网络控制协议（NCP）。
- **可靠性**：**不提供**可靠传输和流量控制，可靠性由上层协议保证。

> [!danger] 易错点总结
> 1. **GBN vs SR 窗口**：GBN的发送窗口 $W_T$ 可以很大，但接收窗口 $W_R$ 必须为1；SR的 $W_T=W_R$ 且都 $\leq 2^{n-1}$。
> 2. **冲突域 vs 广播域**：路由器分割冲突域和广播域；交换机只分割冲突域（VLAN可逻辑分割广播域）；集线器都不分割。 `#2010年`
> 3. **CSMA/CD vs CSMA/CA**：前者用于有线检测冲突，后者用于无线避免冲突（RTS/CTS）。
> 4. **以太网服务**：以太网MAC层是**无连接不可靠**的。


---

## 9. 总结与高频考点

### (1) 关键公式与考点回顾

- **最短帧长**：$\text{最短帧长} = 2 \times \text{带宽} \times \text{最大单向传播时延}$。
- **信道利用率 (S-W)**：$U = \frac{T_D}{T_D + RTT}$。
- **信道利用率 (GBN/SR理想)**：$U_{\text{理想}} = \frac{N \cdot T_D}{T_D + RTT}$。
- **帧编号位数与窗口大小关系**：
    - GBN：$W_T + W_R \leq 2^n$（且 $W_R=1$）。
    - SR：$W_T = W_R \leq 2^{n-1}$（即 $W_T + W_R \leq 2^n$）。
- **CRC纠错条件**：$2^R \geq K+R+1$。

### (2) 真题高频考点

1. **CSMA/CD 的最短帧长计算**：熟练掌握公式及单位转换。
2. **信道利用率分析**：不同可靠传输协议的利用率计算，以及影响因素。
3. **VLAN 标签与帧转发**：理解VLAN标签的插入位置、字段含义，以及交换机如何基于VID进行转发。
4. **MAC 地址表的自学习机制**：模拟交换机在不同帧传输下的学习和转发过程。
5. **直通交换与存储转发**：理解它们的原理、优缺点及适用场景。
6. **冲突域与广播域的区分**：掌握集线器、交换机、路由器对它们的隔离情况。
7. **CSMA/CD 与 CSMA/CA 的对比**：区别"冲突检测"与"冲突避免"的机制（RTS/CTS）。

### (3) 关键对比表

| **技术/协议** | **介质访问方式** | **冲突处理**       | **广播域隔离** | **双工模式**     | **典型帧长** |
| :------------ | :--------------- | :----------------- | :------------- | :--------------- | :----------- |
| **以太网**    | CSMA/CD（半双工） | 冲突检测+重传      | 不隔离         | 半/全双工        | 64~1518B     |
| **WiFi**      | CSMA/CA（全双工） | 预约避免冲突       | 不隔离         | 全双工（MU-MIMO） | 10~2312B     |
| **令牌环网**  | 令牌传递（轮询） | 无冲突             | 不隔离         | 轮询             | 48~4512B     |

### (4) 常见误区与注意事项

1. **VLAN 广播域隔离**：VLAN可以在逻辑上划分广播域，但跨VLAN通信需要**三层交换机或路由器**实现。
2. **无线帧直接通信**：在BSS模式下，802.11规定终端之间**必须通过AP中转**，终端间无法直接通信。
3. **全双工与CSMA/CD**：全双工模式下，发送和接收在不同信道上进行，理论上**不会发生冲突**，因此**无需使用CSMA/CD**协议。只有在半双工模式下才需要CSMA/CD。

> [!danger] 易错点总结
> 1. **GBN vs SR 窗口**：GBN的发送窗口 $W_T$ 可以很大，但接收窗口 $W_R$ 必须为1；SR的 $W_T=W_R$ 且都 $\leq 2^{n-1}$。
> 2. **冲突域 vs 广播域**：路由器分割冲突域和广播域；交换机只分割冲突域（VLAN可逻辑分割广播域）；集线器都不分割。 `#2010年`
> 3. **CSMA/CD vs CSMA/CA**：前者用于有线检测冲突，后者用于无线避免冲突（RTS/CTS）。
> 4. **以太网服务**：以太网MAC层是**无连接不可靠**的。

---
## 🔢 数据链路层计算技巧速查表

| 计算项                         | 关键公式                                                                                | 约束条件/技巧                                                                             |
| :-------------------------- | :---------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------- |
| **传输时延** $T_D$              | $T_D = L / C$                                                                       | $L$: 帧长(bit); $C$: 带宽(bps)。                                                         |
| **争用期** $2\tau$             | $2\tau = L_{\text{min}} / C$                                                        | $L_{\text{min}}$: 最短帧长(bit)。                                                        |
| **信道利用率** $U$               | $U = \frac{T_D}{T_D + RTT_{\text{链路}}}$ (S-W)                                       | $RTT_{\text{链路}} = 2T_{\text{传播}} + T_{\text{确认}}$。                                 |
| **流量利用率** $U$               | $U = \frac{N \cdot T_D}{T_{\text{周期}}}$ (流水线)                                       | $N$: 窗口大小 $W_T$。 $T_{\text{周期}}$: $T_D+RTT_{\text{链路}}$。                            |
| **最小序号位数** $n$              | $2^n \geq W_T + W_R$                                                                | GBN: $n \geq \lceil \log_2(W_T+1) \rceil$； SR: $n \geq \lceil \log_2(2W_T) \rceil$。 |
| **最小汉明距离** $d_{\text{min}}$ | $e \leq d_{\text{min}}-1$; $t \leq \lfloor(d_{\text{min}}-1)/2\rfloor$              | 检错能力 $e$，纠错能力 $t$。                                                                  |
| **CSMA/CA NAV**             | $\text{NAV} = T_{\text{SIFS}} + T_{\text{DATA}} + T_{\text{SIFS}} + T_{\text{ACK}}$ | 隐藏站收 CTS 时，计算预约时间。                                                                  |
| **CSMA/CD 退避**              | $T_{\max} = (2^{\min(n, 10)} - 1) \times 2\tau$                                     | $n$: 冲突次数； $2\tau$: 争用期。                                                            |