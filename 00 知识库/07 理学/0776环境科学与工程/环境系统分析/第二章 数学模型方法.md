---
课程名称: 环境系统分析
授课教师: 王宪恩
tags: []
---

# 第二章 数学模型方法
## 第一节 数学模型的定义和分类         
### 一、数学数学模型的定义和特征
#### 1 数学模型的定义
根据对研究对象所观察到的现象及其实践经验，归纳成一套反映数量关系的数学公式和具体算法，用来描述对象的运动规律，这套公式和算法成为数学模型。  
环境数学模型：应用数学语言和方法来描述环境污染过程中的物理，化学，生物化学，生物生态以及社会等方面的内在规律和相互关系的数学方程。  
$f=\alpha F$  
$C=C_0e^{-K_ct}$

#### 2 数学模型特征
高度的抽象性:通过数学模型能够将形象思维转化为抽象思维，从而可以突破实际系统的约束，运用已有的数学研究成果对研究对象进行深入的研究。这种研究，较之在原型或实物模型上的研究具有很多优点。  
经济性:用数学模型研究不需要过多的专用设备和工具，可以节省大量的设备运行和维护费用，用数学模型可以大大加快研究工作的进度，缩短研究周期。  
局限性:在简化和抽象过程中必然造成某些失真。所谓"模型就是模型"(而不是原型),即是指该性质。
### 二、数学模型的分类
依照变量与时间关系、变量间关系、变量性质、参量性质等不同的划分方法，可以获得不同的数学模型分类

| 划分依据    | 模型类型                |
| ----------- | ----------------------- |
| 变量与时间关系 | 稳态模型      动态模型  |
| 变量间关系   | 线性模型      非线性模型 |
| 变量性质    | 确定性模型    随机性模型  |
## 第二节 数学模型的建立    
### 一、 建立模型的方法
建立数学模型所需的信息通常来自两个方面:  
一是对系统的结构和性质的认识和理解----建立模型的方法称为演绎法；  
一是系统的输入和输出观测数据----建立模型的方法称为归纳法。
#### 1 演绎法
根据对系统的结构和性质的了解,以客观事物变化遵循的物理、化学定律为基础，经逻辑演绎而建立起的模型是机理模型。这种建立模型的方法叫演绎法。机理模型具有唯一性。建立机理模型最主要的方法是质量平衡法。  
$$C=C_0e^{-\frac{Kx}{u_x}}$$  
一维河流水质模型正是基于河流水动力学和污染物迁移规律建立的数学模型，能够描述污染物在河流中的物理、化学和生物过程，是机理模型。
#### 2 归纳法
根据对系统输入输出数据的观测,在数理统计基础上建立起模型的方法又叫归纳法。  
这种模型一般成为经验模型，有多组解。经验模型不具有唯一性，可被多种不同类型的函数描述。因此由归纳法建立起的经验模型在使用时必须注意其导出过程中的取值范围,不可任意进行扩展。

例2-1  在x<4*，由归纳法建立的两函数为：  
$y=4.4(1-e^{-0.86x})$, $y=2.733x-0.433x^2$,  
试绘制其函数图形，并分析其扩展性。  
![[归纳法数学模型的不唯一性和局限性举例.png]]
### 二 、建立数学模型的过程
一个模型要真实反映客观实际，必须经过实践-抽象-实践的多次反复。  
环境数学模型建立：  
是建立在对环境系统进行反复的观察研究之上，通过实验或现场监测取得了大量的有关信息和数据，进而对所研究的系统行为动态、过程本质和变化规律有了较深刻认识的基础上，经过简化和数学演绎而得出的一些数学表达关系，这些表达关系描述了环境系统中各变量及其参数间的关系。  
建立一个能够付诸实用的数学模型要经历的步骤如图2-1所示.  
![[clip_image001 1.png]]  
1. 数据的搜集和初步分析：
2. 模型的结构选择  
	模型的结构大致可分为白箱、灰箱和黑箱三种。  
	(1)白箱模型  
	白箱模型是一种内部机制和工作原理完全透明的数学模型，通常基于明确的物理、化学或生物学规律建立  
	$y=b+kx$      $C=C_0·e^{K_C·t}$  
	 (2)黑箱模型  
	即输入-输出模型。需要大量的输入,输出数据以获得经验模型。它们可在日常例行观察中积累,也可由专门实验获得。  
	$y=2.733x-0.433x^2$
3. 估计模型的参数
4. 模型的检验和修正
5. 模型的应用
### 三、对模型的基本要求
#### 1）要有足够的精确度
精确度是指模型的计算结果和实际测量数值的吻合程度。精确度通常用误差表示。
#### 2）要简单适用
无论怎样精确的模型也存在着如何从原型进行简化的问题。  
简化模型的方法可从两方面进行：一是通过抓主要矛盾，提出简化问题的一些假设，这是物理和化学意义上的简化；一是根据数量级关系进行取舍，这是数学意义上的简化。
#### 3）建立数学模型的依据要充分
依据充分的含义指的是模型在理论推导上要严谨，并且要有可靠的实测数据来检验。
#### 4）模型(优化)中要有可控变量
可控变量又称操纵变量，是指模型中能够控制其大小和变化方向的变量。一个模型中应有一个或多个可控变量，否则这个模型将不能付诸实用。
## 第三节 模型参数的估值方法  
### 一、 图解法
适用范围：凡给定公式可以直接描述一条直线，或经过适当处理后能转换为直线时均可用图解法。$$y=b+kx$$  
方法： 将自变量x和因变量y的各自对应点画在直角坐标纸上，用直尺将所有的点连成一条直线，使直线尽可能靠近每一个点。  
$y=b+kx,$  则斜率为k，截距为b  
斜率k可以通过计算两点之间的变化率来确定。例如，选择两个相邻的数据点 (x1​,y1​) 和  (x2​,y2​)，则斜率 k 的估计值为：  
$k=\frac{y_2-y_1}{X_2-X_1}$  
误差：点位的精度和绘制直线的精度。  
总体误差为0.5％
### 二、一元线性回归分析（最小二乘法）
两个假设：  
1）所有自变量的值均不存在误差，因变量的值则含有测量误差  
2）与各自测量点拟合最好的直线为能使各点到直线的竖向偏差的平方和最小的直线（也就是将尽可能地靠近所有的点）。  
设有n对x.,y的值适合线性方程    $y=b+kx$。  
如果已知b、k的值，就可以根据自变量$x_i$的值计算出对应的因变量的值设为$y_i$'，另$d_i$为测量值与计算值的偏差，则：  
$d_i=y_i-y_i'=y_i-(b+k·x_i)$  
偏差平方和：$$z^2=\sum_{i=1}^nd_i^2=\sum_{i=1}^n[y_i-(b+k\cdot x_i)]^2  $$  
为使平方和最小，他们必需满足必要条件：  $$\frac{\partial z}{\partial b}=0$$  
解得：$$\mathrm{b~}=\frac{\sum_{i=1}^nX_i\sum_{i=1}^nX_iy_i-\sum_{i=1}^ny_i\sum_{i=1}^nx_i^2}{(\sum_{i=1}^nX_i)^2-n\sum_{i=1}^nx_i^2}$$  
$$k^2=\frac{\sum_{i=1}^nx_i\sum_{i=1}^ny_i-n\sum_{i=1}^nx_iy_i}{(\sum_{i=1}^nx_i)^2-n\sum_{i=1}^nx_i^2}$$
### 例 下表为x与y的一组对应值，试用图解法和一元线性回归分析求线性方程$y=b+kx$中的b和k

| ![](file:///C:/Users/gjh99/AppData/Local/Temp/msohtmlclip1/02/clip_image022.png) | 1   | 3   | 8   | 10  | 13  | 15  | 17   | 20   |
| -------------------------------------------------------------------------------- | --- | --- | --- | --- | --- | --- | ---- | ---- |
| ![](file:///C:/Users/gjh99/AppData/Local/Temp/msohtmlclip1/02/clip_image024.png) | 3.0 | 4.0 | 6.0 | 7.0 | 8.0 | 9.0 | 10.0 | 11.0 |
#### （1）图解法
![[clip_image026.png]]  
$b=2.73$  
![[clip_image030.png]]  
线性方程为：$y=2.73+0.418·x$
#### （2）一元线性回归分析（最小二乘法）
解：计算  
$\sum\limits_{i=1}^8 x_i=87$  
$\sum\limits_{i=1}^8 y_i=58.0$  
$\sum\limits_{i=1}^8 x^2_i=1257$  
$\sum\limits_{i=1}^8 x_i·y_i=762.0$  
  计算：  $b=2.66,k=0.42$  
线性方程为：$y=2.66+0.42·x$（最小二乘法）  
线性方程为：$y=2.73+0.418·x$   (作图法)

## 第四节  模型的验证与误差分析
参数估值之后，在模型应用之前还要进行模型验证，模型验证以模型的计算结果和试验观测数据之间的吻合程度来判断
### 一、相关系数法
相关系数是用来度量计算值和观测值的吻合程度的量，用r表示：![[clip_image049.png]]  
其中$y_i,y_i'$为测量值和计算值,$\overline{y},\overline{y_i'}$为测量值和计算值的平均值。  
可以证明：0≤r≤1,r 越大,相关性越好  
   一般情况下，r值大于0.7即可。
### 二  相对误差法
**相对误差的定义：**![[clip_image002 1.png]]  
**相对误差：0.02、** **0.05、0.15、0.35、0.4、0.55、0.6、0.78、0.85、0.95**
#### 1. 作图法
1）将n组观测值与计算值按$y=\frac{|y_i-y_i'|}{y_i}$计算，得到n个相对误差值  
2）将这几个误差值从小到大排列，以求得小于某一误差值的误差出现频率，以及累积频率为10％、50％、90％的误差。  
3）分析这三个误差值，确定模型的精确度。  
![[Pasted image 20250614205848.png]]  
这种表达方法的缺点是在上、下区界(10％、90％)附近的统计分布很差，因此通常采用中值误差(累积频率为50％)作为衡量模型精确度的度量。
#### 2. **计算方法**
**可以确定，中值误差与统计学上的概率误差是一致的，中值误差的数值既可以从误差分布的累积曲线(上图)上求出，也可以按下式计算：**  
相对中值误差：**![](file:///C:/Users/gjh99/AppData/Local/Temp/msohtmlclip1/02/clip_image002.png)  
绝对中值误差：![[clip_image004 1.png]]  
相关系数r值越大，相对误差越小，相关性越好，精度越高。  
图解法：$y=2.73+0.418·x$  
最小二乘法: $y=2.66+0.42·x$

**例**

| $x$   | **1**    | **3**    | **8**    | **10**   | **13**   | **15**   | **17**   | **20**     |     |
| ----- | -------- | -------- | -------- | -------- | -------- | -------- | -------- | ---------- | --- |
| $y$   | **3.0**  | **4.0**  | **6.0**  | **7.0**  | **8.0**  | **9.0**  | **10.0** | **11.0**   |     |
| $y'$  | **3.15** | **3.98** | **6.07** | **6.91** | **8.16** | **9.00** | **9.84** | **11.09**  |     |
| $y''$ | **3.08** | **3.92** | **6.02** | **6.86** | **8.12** | **8.96** | **9.8**  | **11.06**  |     |
|       | 0.002434 | 0.000016 | 0.000152 | 0.000165 | 0.00042  | 0        | 0.000269 | 6.6942E-05 |     |
|       | 0.000711 | 0.0004   | 1.11E-05 | 0.0004   | 0.000225 | 1.98E-05 | 0.0004   | 2.9752E-05 |     |  
$y=2.73+0.418·x$  
![[clip_image023.png]]  
$y=2.66+0.42·x$  
![[clip_image026 1.png]]
## 第五节 灵敏度分析
**环境是一个开放系统，自然因素和人们的社会活动都对环境产生影响，并且，影响复杂很难精确定量。**  
$$c=c_0\cdot\exp(-k\cdot\frac{x}{u_x})$$  
![[第二章 数学模型方法 2025-06-14 21.08.34.excalidraw]]

### 一 灵敏度分析的意义  
#### 模型灵敏度分析原因
1. 对环境产生的影响很难精确定量；
2. 在环境模拟和规划中应用的各种数学模型存在不确定性；
3. 模型中的参数存在误差。  
#### 意义
1. 通过对模型灵敏度分析可以估计模型计算结果的偏差；
2. 灵敏度分析还有助于建立低灵敏度系统；
3. 有助于确定合理的设计裕量。
### 二 灵敏度定义
一个最优化模型通常由状态方程和目标函数构成，状态方程表达周围的环境条件的约束，一般形式如下：  
$$\begin{cases}
 & M_{in}Z=f(\bar{x},\bar{\mu},\bar{\theta}) \\
 & s.t.G \\
 & f(\bar{x},\bar{\mu},\bar{\theta})=0
\end{cases}$$
式中：
	Z :目标
	$\bar{x}$ ：系统的状态向量，由描述系统的各种状态组成；系统内污染物浓度等
	$\bar{μ}$ ：系统的决策向量，由系统的可控变量组成； 
	   ：污染物的排放量、处理设施的处理效率等
	$\bar{\theta}$ ：系统的参数向量，由系统的各种参数组成。降解系数等

在系统环境的模拟中，灵敏度的研究主要包括两个方面：
	1) 状态与目标对参数的灵敏度。 
	2) 目标对状态的灵敏度。
### 三 状态与目标对参数的灵敏度 
#### 1 单个变量时的灵敏度
假设：状态变量和参数的数目都为1
	决策变量μ ＝* μ 保持不变
那么$x= f(\theta)$ 其中$x^*= f(\theta_0)$
	$z= F(\theta)$ 其中$z^*= F(\theta_0)$
式中：$x^*$ ，$z^*$ 分别为相对于$f(\theta_0)$的状态变量和目标函数值。 
#### 2 灵敏度的定义： 
在$\theta=\theta_0$附近，状态变量（或目标函数）相对于原值的变化率和参数$\theta$相对于$\theta_0$的变化率的比值，称为状态变量（或目标函数）对参数的灵敏度。 
$$\begin{cases}
 & S_\theta^Z=\frac{\frac{\Delta Z}{Z^*}}{\frac{\Delta \theta}{\theta_0}}=(\frac{\Delta Z}{\Delta\theta})\cdot\frac{\theta_0}{Z^*} \\
 & S_\theta^x=\frac{\frac{\Delta x}{x^*}}{\frac{\Delta\theta}{\theta_0}}=(\frac{\Delta x}{\Delta\theta})\cdot\frac{\theta_0}{x^*}
\end{cases}$$
式中：$\Delta x=x-x^*\quad\Delta Z=Z-Z^*\quad;\quad\Delta\theta=\theta-\theta_0$
当$\Delta \theta→0$ 时，$$\mathbf{S}_\theta^\mathrm{z}=(\frac{dz}{d\theta})_{\theta=\theta_0}\cdot\frac{\theta_0}{z^*}$$
式中$(\frac{dx}{d\theta})_{\theta=\theta_0}$和$(\frac{dz}{d\theta})_{\theta=\theta_0}$分别称为状态变量和目标函数对参数的一阶灵敏度系数，它可以反应系统的灵敏度特征。
