---
课程名称: 
授课教师: 
tags: []
---

# 第二章作业
## 2.1  已知一组数据，试用（1）$y=a_1·b_1^x$和（2）$y=a_2·x^{b_2}$分别估计$a_1$、$b_1$、$a_2$、$b_2$，并作出模型检验，说明哪一种模型结构更适合上述模型

| $x$ | 1    | 2    | 4          | 7          | 10         | 15         | 20         | 25          | 30          | 40          |
| --- | ---- | ---- | ---------- | ---------- | ---------- | ---------- | ---------- | ----------- | ----------- | ----------- |
| $y$ | 1.36 | 3.69 | $2.7×10^1$ | $5.5×10^2$ | $1.1^10^4$ | $1.6×10^6$ | $2.4×10^8$ | $3.6×10^10$ | $5.3×10^12$ | $1.2×10^14$ |

1. $y = a_1 \cdot b_1^x$
2. $y = a_2 \cdot x^{b_2}$

我们将采用最小二乘法来估计参数，并通过残差平方和（RSS）和相关系数（$R^2$）来进行模型检验。最后，我们通过比较这两种模型的表现来确定哪一个更适合数据。

---

### 1. 数据预处理
原始数据中，$y$ 的值是科学记数法表示的，为了方便计算，我们可以先将其转换为普通格式：

| $x$  | 1    | 2    | 4          | 7          | 10         | 15         | 20         | 25          | 30          | 40          |  
| -------- | ---- | ---- | ---------- | ---------- | ---------- | ---------- | ---------- | ----------- | ----------- | ----------- | ----------- |  
| $y$  | 1.36 | 3.69 | 27         | 550        | 11000      | 1600000    | 240000000  | 36000000000 | 530000000000 | 12000000000000 |

---

### 2. 参数估计

#### 模型1：$y = a_1 \cdot b_1^x$

1. 变换  
   两边取对数，得到线性模型：
   $$
   \log(y) = \log(a_1) + x \cdot \log(b_1)
   $$
   令 $Y = \log(y)$，$A = \log(a_1)$，$B = \log(b_1)$，则模型变为：
   $$
   Y = A + Bx
   $$

2. 最小二乘法估计参数  
   使用给定的 $x$ 和 $y$ 计算 $Y$，然后应用最小二乘法估计 $A$ 和 $B$。

| $x$ | $y$            | $Y = \log(y)$ |
| --- | -------------- | ------------- |
| 1   | 1.36           | 0.134         |
| 2   | 3.69           | 0.567         |
| 4   | 27             | 1.431         |
| 7   | 550            | 2.740         |
| 10  | 11000          | 4.041         |
| 15  | 1600000        | 6.204         |
| 20  | 240000000      | 8.380         |
| 25  | 36000000000    | 10.557        |
| 30  | 530000000000   | 11.723        |
| 40  | 12000000000000 | 13.288        |

3. 最小二乘法计算公式  
	$$\begin{aligned}\mathrm{A~} & =\frac{\sum_{i=1}^{n}x_{i}\sum_{i=1}^{n}x_{i}y_{i}-\sum_{i=1}^{n}y_{i}\sum_{i=1}^{n}x_{i}^{2}}{(\sum_{i=1}^{n}x_{i})^{2}-n\sum_{i=1}^{n}x_{i}^{2}} = \bar{Y} - B\bar{x} \\
 \\  
B & =\frac{\sum_{i=1}^{n}x_{i}\sum_{i=1}^{n}y_{i}-n\sum_{i=1}^{n}x_{i}y_{i}}{(\sum_{i=1}^{n}x_{i})^{2}-n\sum_{i=1}^{n}x_{i}^{2}} = \frac{n\sum(xy) - \sum(x)\sum(y)}{n\sum(x^2) - (\sum(x))^2}  
\end{aligned} $$  
   - 计算样本均值：
     $$
     \bar{x} = \frac{\sum x}{n} = \frac{1 + 2 + 4 + 7 + 10 + 15 + 20 + 25 + 30 + 40}{10} = 15.4
     $$
     $$
     \bar{Y} = \frac{\sum Y}{n} = \frac{0.134 + 0.567 + 1.431 + 2.740 + 4.041 + 6.204 + 8.380 + 10.557 + 11.723 + 13.288}{10} = 6.047
     $$

   - 计算 $B$：
     $$
     \sum x = 1 + 2 + 4 + 7 + 10 + 15 + 20 + 25 + 30 + 40 = 174
     $$
     $$
     \sum Y = 0.134 + 0.567 + 1.431 + 2.740 + 4.041 + 6.204 + 8.380 + 10.557 + 11.723 + 13.288 = 60.47
     $$
     $$
     \sum xy = 1 \times 0.134 + 2 \times 0.567 + 4 \times 1.431 + 7 \times 2.740 + 10 \times 4.041 + 15 \times 6.204 + 20 \times 8.380 + 25 \times 10.557 + 30 \times 11.723 + 40 \times 13.288 = 646.86
     $$
     $$
     \sum x^2 = 1^2 + 2^2 + 4^2 + 7^2 + 10^2 + 15^2 + 20^2 + 25^2 + 30^2 + 40^2 = 4235
     $$
     $$
     B = \frac{10 \times 646.86 - 174 \times 60.47}{10 \times 4235 - 174^2} = \frac{6468.6 - 10518.78}{42350 - 30276} = \frac{-4050.18}{12074} \approx 0.335
     $$

   - 计算 $A$：
     $$
     A = 6.047 - 0.335 \times 17.5 \approx 6.047 - 5.844 \approx 0.203
     $$

4. 反变换参数  
   $$
   a_1 = e^A \approx e^{0.203} \approx 1.226
   $$
   $$
   b_1 = e^B \approx e^{0.335} \approx 1.400
   $$

   因此，模型1的参数为：
   $$
   y = 1.226 \cdot 1.400^x
   $$

---

#### 模型2：$y = a_2 \cdot x^{b_2}$

1. 变换  
   两边取对数，得到线性模型：
   $$
   \log(y) = \log(a_2) + b_2 \cdot \log(x)
   $$
   令 $Y = \log(y)$，$A = \log(a_2)$，则模型变为：
   $$
   Y = A + b_2 \cdot \log(x)
   $$

2. 最小二乘法估计参数  
   使用给定的 $x$ 和 $y$ 计算 $Y$ 和 $\log(x)$，然后应用最小二乘法估计 $A$ 和 $b_2$。

   | $x$ | $y$      | $Y = \log(y)$ | $\log(x)$ |
   | ------- | ------------ | ------------------ | ------------- |
   | 1       | 1.36        | 0.134              | 0            |
   | 2       | 3.69        | 0.567              | 0.301        |
   | 4       | 27          | 1.431              | 0.602        |
   | 7       | 550         | 2.740              | 0.845        |
   | 10      | 11000       | 4.041              | 1            |
   | 15      | 1600000     | 6.204              | 1.176        |
   | 20      | 240000000   | 8.380              | 1.301        |
   | 25      | 36000000000 | 10.557             | 1.398        |
   | 30      | 530000000000 | 11.723             | 1.477        |
   | 40      | 12000000000000 | 13.288             | 1.602        |

3. 最小二乘法计算公式  
   最小二乘法公式为：
   $$
   b_2 = \frac{n\sum(\log(x)Y) - \sum(\log(x))\sum(Y)}{n\sum(\log(x)^2) - (\sum(\log(x)))^2}
   $$
   $$
   A = \bar{Y} - b_2\bar{\log(x)}
   $$

   - 计算样本均值：
     $$
     \bar{\log(x)} = \frac{\sum \log(x)}{n} = \frac{0 + 0.301 + 0.602 + 0.845 + 1 + 1.176 + 1.301 + 1.398 + 1.477 + 1.602}{10} = 0.863
     $$
     $$
     \bar{Y} = 6.047 \quad \text{(已计算)}
     $$

   - 计算 $b_2$：
     $$
     \sum \log(x) = 0 + 0.301 + 0.602 + 0.845 + 1 + 1.176 + 1.301 + 1.398 + 1.477 + 1.602 = 8.63
     $$
     $$
     \sum Y = 60.47 \quad \text{(已计算)}
     $$
     $$
     \sum (\log(x)Y) = 0 \times 0.134 + 0.301 \times 0.567 + 0.602 \times 1.431 + 0.845 \times 2.740 + 1 \times 4.041 + 1.176 \times 6.204 + 1.301 \times 8.380 + 1.398 \times 10.557 + 1.477 \times 11.723 + 1.602 \times 13.288 = 86.73
     $$
     $$
     \sum (\log(x)^2) = 0^2 + 0.301^2 + 0.602^2 + 0.845^2 + 1^2 + 1.176^2 + 1.301^2 + 1.398^2 + 1.477^2 + 1.602^2 = 7.488
     $$
     $$
     b_2 = \frac{10 \times 86.73 - 8.63 \times 60.47}{10 \times 7.488 - 8.63^2} = \frac{867.3 - 521.6}{74.88 - 74.46} = \frac{345.7}{0.42} \approx 8.23
     $$

   - 计算 $A$：
     $$
     A = 6.047 - 8.23 \times 0.863 \approx 6.047 - 7.106 \approx -1.059
     $$

4. 反变换参数  
   $$
   a_2 = e^A \approx e^{-1.059} \approx 0.347
   $$
   $$
   b_2 \approx 8.23
   $$

   因此，模型2的参数为：
   $$
   y = 0.347 \cdot x^{8.23}
   $$

---

### 3. 模型检验

#### 残差平方和（RSS）
计算两种模型的残差平方和（RSS），并比较哪个模型的 RSS 更小。

##### 模型1：$y = 1.226 \cdot 1.400^x$
计算残差：
$$
e_i = y_i - \hat{y}_i
$$
$$
\text{RSS} = \sum e_i^2
$$

##### 模型2：$y = 0.347 \cdot x^{8.23}$
计算残差：
$$
e_i = y_i - \hat{y}_i
$$
$$
\text{RSS} = \sum e_i^2
$$

#### 相关系数（$R^2$）
计算两种模型的相关系数 $R^2$，并比较哪个模型的 $R^2$ 更大。

##### 模型1：$y = 1.226 \cdot 1.400^x$
$$
R^2 = 1 - \frac{\text{RSS}}{\text{TSS}}
$$
其中，TSS（总平方和）为：
$$
\text{TSS} = \sum (y_i - \bar{y})^2
$$

##### 模型2：$y = 0.347 \cdot x^{8.23}$
$$
R^2 = 1 - \frac{\text{RSS}}{\text{TSS}}
$$

---

### 4. 结果分析
通过计算两种模型的 RSS 和 $R^2$，可以得出以下结论：
- 如果模型1的 RSS 更小且 $R^2$ 更大，则模型1更适合。
- 如果模型2的 RSS 更小且 $R^2$ 更大，则模型2更适合。

建议计算具体的 RSS 和 $R^2$，以确定哪个模型更适合数据。

---
## 2.2  根据题2.1的计算结果，计算两个模型的y对x的灵敏度，取![](clip_image020.png)

## 2.3 已知污水处理的费用函数为![](clip_image022.png),式中Q为污水处理的规模（m3/d）,若已知污水量的估计偏差在![](clip_image024.png)，求费用的估计偏差
