---
课程名称: 环境规划
授课教师: 宋俊年
创建时间: 
tags: []
date created: 星期日, 四月 20日 2025, 1:52:34 下午
date modified: 星期二, 四月 22日 2025, 1:44:39 下午
---

# 熵权法
**熵** 指的是体系的混乱的程度。  
**熵权**则可反映各指标对评价对象的贡献激烈程度，可用来定量判别不同决策变量在决策系统中的重要性程度

基于熵权法的多目标决策  
	- 建立指标体系  
	- 建立初始决策矩阵  
	- 确定权重  
	- 综合判断

## 1. 建立指标体系
![[第4章 环境规划的技术方法2.pdf#page=54&rect=78,62,728,458|第4章 环境规划的技术方法2, p.54]]
## 2. 建立初始决策矩阵  
m 个被评价对象， n 个指标的评估问题,建立初始决策矩阵
$$C=
\begin{bmatrix}
c_{11} & c_{12} & \cdots & c_{1n} \\
c_{21} & c_{22} & \cdots & c_{2n} \\
\vdots & \vdots & \vdots & \vdots \\
c_{m1} & c_{m2} & \cdots & c_{mn}
\end{bmatrix}$$
其中，$C$为初始决策矩阵；$c_{ij}$为评估具体指标，$i=1,2,\ldots,m$；$j=1,2,\ldots,n$。
## 3. 确定权重 
### 1)  指标归一化处理
1. 消除量纲差异，将原始数据归一化到 [0,1] 区间：
$$Y_{i,j}=\begin{cases}
\frac{c_{ij}}{\left[\sum\limits_{i=1}^{m}c_{ij}^{2}\right]^{\frac{1}{2}}}=\frac{c_{ij}}{c_{max}} & \text{越大越优型}\\
-\frac{c_{ij}}{\left[\sum\limits_{i=1}^{m}c_{ij}^{2}\right]^{\frac{1}{2}}}==\frac{c_{ij}}{c_{min}} & \text{越小越优型}
\end{cases}$$
2. 初始决策矩阵进行标准化后，可以得到标准决策矩阵Y	$$\mathbf{Y} = \begin{bmatrix}
Y_{1,1} & Y_{1,2} & \cdots & Y_{1,n-1} & Y_{1,n} \\
Y_{2,1} & Y_{2,2} & \cdots & Y_{2,n-1} & Y_{2,n} \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
Y_{m-1,1} & Y_{m-1,2} & \cdots & Y_{m-1,n-1} & Y_{m-1,n} \\
Y_{m} & Y_{m} & \cdots & Y_{m,n-1} & Y_{m,n}
\end{bmatrix}$$
	$Y_{ij}$ 为第 i 个地区、第 j 个指标的特征值
### 2) 定义熵
在有 m个被评价对象， n个指标的评估问题中，第 j个指标的熵定义为:
$$H_j=-k\sum_{i=1}^mp_{ij}\ln^2p_{ij}$$
式中：$k=1/\ln m$   ，$p_{ij}=\frac{Y_{ij}}{\sum_{i=1}^mY_{ij}}$
$H_i$代表第$j$项指标的熵，表征各指标的异质性；
$P_{ij}$为第$j$项指标在第$i$个对象中所占的比重；
$当p_{ij}=0时，令p_{ij}\ln p_{ij}=0$

### 3) 定义熵权
如果指标的信息熵越小，该指标提供的信息量越大，在综合评价中所起作用理当越大，权重就应该越高。因此，各指标的熵权定义如下:
$$w_{j}=\frac{1-H_{j}}{\sum_{j=1}^{n}(1-H_{j})}$$
$$
0 \leq w_{j} \leq 1$$  
$W_{j}$为第j个指标的熵权

### 4) 计算样本综合得分
根据权重计算各样本总得分：
$$
\text{得分}_i = \sum_{j=1}^n w_j \cdot Y_{ij}
$$
## 4. 综合判断
# **熵权法特点**
| **优点**                  | **缺点**                  | **适用场景**             |
|---------------------------|---------------------------|--------------------------|
| 完全客观，依赖数据自身分布 | 忽略指标实际意义          | 数据量大，需排除主观干扰 |
| 计算简单，可解释性强       | 对极端值敏感              | 指标间独立性较高         |
| 适用于多指标综合评价       | 可能低估低离散度指标重要性| 金融、环境、管理等领域   |

---

# 例题
以下是基于熵权法计算 **样本A、B、C权重** 的分步解析：

---

## **1. 数据标准化（正向指标）**
对每个指标进行极差归一化处理，消除量纲差异：
$$
x_{ij}' = \frac{x_{ij} - \min(x_j)}{\max(x_j) - \min(x_j)}
$$

| 样本 | 指标1 | 指标2 | 指标3 |
|------|-------|-------|-------|
| A    | 0.75  | 0.0   | 1.0   |
| B    | 1.0   | 1.0   | 0.0   |
| C    | 0.0   | 0.0   | 0.5   |

**计算说明**：
- **指标1**：$\max=5$, $\min=1$  
  $A'=(4-1)/(5-1)=0.75$, $B'=(5-1)/(5-1)=1.0$, $C'=(1-1)/(5-1)=0.0$
- **指标2**：$\max=4$, $\min=2$  
  $A'=(2-2)/(4-2)=0.0$, $B'=(4-2)/(4-2)=1.0$, $C'=(2-2)/(4-2)=0.0$
- **指标3**：$\max=3$, $\min=1$  
  $A'=(3-1)/(3-1)=1.0$, $B'=(1-1)/(3-1)=0.0$, $C'=(2-1)/(3-1)=0.5$

---

## 2. 计算信息熵
对每个指标计算信息熵：
$$
H_j = -\frac{1}{\ln(3)} \sum_{i=1}^m p_{ij} \ln p_{ij}
$$
其中 $p_{ij} = x_{ij}' / \sum_{i=1}^m x_{ij}'$。

| 指标 | 样本A比重 $p_{Aj}$ | 样本B比重 $p_{Bj}$ | 样本C比重 $p_{Cj}$ | 信息熵 $H_j$ |
|------|----------------------|----------------------|----------------------|----------------|
| 1    | 0.4286               | 0.5714               | 0.0                  | 0.619          |
| 2    | 0.0                  | 1.0                  | 0.0                  | 0.0            |
| 3    | 0.6667               | 0.0                  | 0.3333               | 0.579          |

**计算示例**：
- **指标1**：  
  $$
  H_1 = -\frac{1}{\ln(3)} \left( 0.4286 \ln 0.4286 + 0.5714 \ln 0.5714 \right) \approx 0.619
  $$
- **指标2**：  
  $$
  H_2 = -\frac{1}{\ln(3)} \cdot 1.0 \ln 1.0 = 0
  $$

---

## **3. 计算熵权**
通过差异系数 $d_j = 1 - H_j$ 确定指标权重：
$$
w_j = \frac{d_j}{\sum_{j=1}^n d_j}
$$

| 指标 | 信息熵 $H_j$ | 差异系数 $d_j$ | 权重 $w_j$ |
|------|----------------|------------------|--------------|
| 1    | 0.619          | 0.381            | **21.2%**    |
| 2    | 0.0            | 1.0              | **55.5%**    |
| 3    | 0.579          | 0.421            | **23.3%**    |

---

## **4. 计算样本综合得分**
根据权重计算样本总得分：
$$
\text{得分} = \sum_{j=1}^3 w_j \cdot x_{ij}'
$$

| 样本 | 指标1贡献 | 指标2贡献 | 指标3贡献 | 综合得分 | 归一化权重 |
|------|-----------|-----------|-----------|----------|------------|
| A    | 0.381×0.75 | 0.0×0.0   | 0.421×1.0 | 0.392    | **30.7%**  |
| B    | 0.381×1.0 | 1.0×1.0   | 0.421×0.0 | 0.766    | **60.1%**  |
| C    | 0.381×0.0 | 0.0×0.0   | 0.421×0.5 | 0.117    | **9.2%**   |

---

## **5. 最终结果**
| 样本 | 权重   | 排名 |
|------|--------|------|
| B    | 60.1%  | 1    |
| A    | 30.7%  | 2    |
| C    | 9.2%   | 3    |

---

## **关键结论**
1. **指标权重**：指标2（权重55.5%）对结果影响最大，因其数据离散程度最小（全部分布在极值）。
2. **样本B优势**：在核心指标2上表现最佳（标准化为1.0），权重占比最高。
3. **熵权法局限**：若指标实际重要性未被数据离散度反映，需结合主观赋权法（如AHP）优化。
