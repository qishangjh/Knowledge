---
课程名称: 
授课教师: 
tags: []
---

# 3vb语言基础
## 3.1 字符集和关键字
### 3.1.1 字符集
VB将能识别的所有字符称为字符集。  
字符集包括以下几种：  
数字：0-9  
字母：26个大小写字母，不区分大小写  
特殊字符：键盘上的其他字符以及汉字
### 3.1.2 关键字
系统提供的保留字。  
如：private   print    dim   const   integer   date等。

## 3.2 数据类型
### 3.2.1 数据类型概述
   根据数据描述信息的含义，可以将数据分为不同的种类，简称数据类型。
### 3.2.2 基本数据类型
#### 1. 数值型数据
##### （1）整数型
###### 1）整型（Integer，类型符%)  
在内存中占2字节，十进制整型数的取值范围：-32768~32767。  
###### 2）长整型(Long，类型符&)  
在内存中占4字节，以&结尾。如：123456&&
##### （2）实数型(浮点型）
可分为单精度浮点型和双精度浮点型  
###### 1）单精度浮点型（Single,类型符!)  
占4个字节，有效位数7位十进制数。  
###### 2）双精度浮点型（Double，类型符#）  
占8个字节，有效位数15到16位十进制数。
#### 2. 货币型(Currency，类型符@)
在内存中占8字节，与浮点数的区别：小数点后的位数是固定的4位。如：65.1234@  
#### 3. 字节型(Byte，无类型符）  
一般用于存储二进制数据。内存中占1个字节。数据范围：0~255
#### 4. 日期型（Date，无类型符）
在内存中占8字节，可表示的范围为：1000年1月1日~9999年12月31日,时间表示范围为：00：00：00~23：59：59  
用一对#号括起来放置日期和时间。  
日期可用#09/10/2000#或#2000-09-12#表示  
时间可用#08:30:00 AM#表示
#### 5. 逻辑型（Boolean，无类型符）
在内存中占2个字节。逻辑型数据有两个可能的值：True和False。  
注意：  
若将逻辑型数据转换成数值型，则True转为-1，False转为0。  
若将数值型数据转换为逻辑型，则非0的数据转为True，0转为False。  
Dim boolr as Boolean  
Boolr=6>8  
Print boolr
#### 6.字符串类型（String，类型符为$)
用双引号引上的一个或多个字符，字符的个数称为字符串的长度。  
长度为零的字符串称为空字符串。
##### （1）变长字符串类型
变长字符串类型的长度为字符串长度。  
Dim a as string  
a="456789"  
Print len(a)
##### （2）定长字符串类型
如果要声明字符串具有固定长度，可用以下语法：  
string * 字符串长度  
Dim a as string* 5  
a="456789"  
Print len(a)
#### 7.对象数据类型（Object，无类型符)
在内存中占4个字节。  
dim a as Object  
a 可以存放某一个对象。  
如:  
dim a as object  
set a=form1
#### 8. 变体数据类型（Variant,无类型符）
可以表示多种数据类型，其最终的类型由赋予它的值来确定。  
Dim a  
a="abcdefgh"  
a=15
## 3.3 常量和变量
### 3.3.1 常量
  在程序执行过程中，其值不变的量。
#### 1. 直接常量（常数）
##### 整形常数
1）十进制整数。如：125、0、-89  
2）八进制整数。以&或&O开头的整数是八进制整数。如：&O25  
3）十六进制整数。以&H开头的整数是十六进制整数，如：&H25
##### 实型常数
NaN. 十进制小数形式  
如：0.123,  .123, 123.0 ,  123! ,  123#  
NaN. 指数形式  
如：21E5
##### 日期常量
以#号引上的日期型常量
##### 字符常量
以双引号引上的常量
#### 2. 用户声明常量
声明格式为：  

```vb
Const  常量名  [As 类型] =表达式 
``` 

如：  
Const   PI=3.1415926  
Const   conMax as integer=9
#### 3. 系统提供的常量
如：VbRed表示红色，可以在"对象浏览器"中查看内部常量。  
在视图/对象浏览器下选择VBA下的Constants。  
 Text1.ForeColor=vbRed
### 3.3.2 变量
#### 1. 值可以改变的量
变量的**命名规则**  
  1）变量名可以由**字母、数字和和下划线**组成。  
  2）变量名必须以字母打头  
  3）变量名的长度不得超过255个字符  
  4）变量名不能和关键字同名
#### 2. 变量的声明
（1）显式声明  
	Dim  变量名  as  数据类型  
（2）隐式声明  
	不声明变量而直接使用，所有隐式声明的变量都是Variant数据类型。  
（3）强制显式声明  
	可以在通用声明段中加入语句：Option Explicit。
## 3.4 运算符与表达式
### 3.4.1 运算符
#### 1. 算术运算符

| 运算符 | 含义  | 优先级 | 实例       | 结果        |
| --- | --- | --- | -------- | --------- |
| ^   | 乘方  | 1   | 3^2      | 9         |
| -   | 负号  | 2   | -3       | -3        |
| *   | 乘   | 3   | 3*3      | 9         |
| /   | 除   | 3   | 10/3     | 3.3333333 |
| \   | 整除  | 4   | 10\3     | 3         |
| Mod | 取余  | 5   | 10 mod 3 | 1         |
| +   | 加   | 6   | 10+3     | 13        |
| -   | 减   | 6   | 3-10     | -7        |
计算表达式：  

```vb
5+10 mod 10\9/3+2^2
```

#### 2. 字符串运算符
##### （1）用于连接字符串
连接运算就是将两个表达式连接一起。  
连接运算符有两个——"&"和"+"。  
"&"运算用来强制两个表达式字符串连接，而"+"运算则有些不同，如果两个表达式都为字符串，则将两个字符串连接；如果一个是字符串而另一个是数字则进行相加操作。  
**两种连接运算符"&"和"+"的比较**

| 表达式1   | 表达式2 | 进行"&"运算的结果 | 进行"+"运算的结果 |
| ------ | ---- | ---------- | ---------- |
| "456"  | "2"  | "4562"     | "4562      |
| 456    | 2    | "4562"     | 458        |
| "456"  | 2    | "4562"     | 458        |
| "456b" | 2    | "456b2"    |            |
##### （2）用于比较字符串
Like用于模糊比较字符串。格式为：  

```vb
result=string Like pattern  
```

如：  

```vb
Mybool="王三" Like "王*"
```

#### 3. 关系运算符
比较规则：  
1）两个操作数是数值型，则按大小进行比较  
2）两个操作数是字符型，则按字符的ASCII码值从左到右逐一进行比较。

| 运算符  | 含义    | 实例                | 结果    |
| ---- | ----- | ----------------- | ----- |
| =    | 等于    | "ABCDE"="ABR"     | False |
| >    | 大于    | "ABCDE">"ABR"     | False |
| >=   | 大于或等于 | "bc">="大小"        | False |
| <    | 小于    | 23<3              | False |
| <=   | 小于或等于 | "23"<="3"         | True  |
| <>   | 不等于   | "abc"<>"ABC"      | True  |
| Like | 字符串匹配 | "ABDEF"like"*DE*" | True  |
#### 4. 逻辑运算符

| 运算符 | 含义  | 优先级 | 说明                    |
| --- | --- | --- | --------------------- |
| Not | 取反  | 1   | 假取反为真，真取反为假           |
| And | 与   | 2   | 两个操作都为真时，结果为真，否则结果为假  |
| Or  | 或   | 3   | 有一个操作数为真时，结果为真。       |
| Xor | 异或  | 3   | 两个操作数一真一假时，结果为真，否则为假。 |
| Eqv | 同或  | 3   | 两个操作数一真一假时，结果为假，否则为真。 |
### 3.4.2 表达式
#### 1. 表达式的组成
由运算符和操作数组合而成。
#### 2. 不同数据类型的转化
数据类型转化的规律：  
Integer<Long<Single<Double<Currency'  

```vb
5+7.6=12.6  
30-True=31  
5+"7"=12
```

#### 3. 优先级
基本规律为：  
算术运算符>字符运算符>关系运算符>逻辑运算符
#### 4. 表达式的运算

```vb
3>2* 4 Or 3=5 and 4<>5 or 5>6
```

## 3.5 常用内部函数
### 3.5.1 数学函数

| 函数名            | 说明                  |
| -------------- | ------------------- |
| Sin            | 返回孤度的正弦             |
| Cos            | 返回弧度的余弦             |
| Atn            | 返回用弧度表示的反正切值        |
| Tan            | 返回弧度的正切             |
| Abs            | 返回数的绝对值             |
| Exp            | 返回e的指定次幂            |
| Log            | 返回一个数值的自然对数         |
| Sgn            | 返回数的符号值             |
| Sqr            | 返回数的平方根             |
| Int            | 返回不大于给定数的最大整数       |
| Fix            | 返回数的整数部分            |
| Asc()          | 字符转换成ASCII码值        |
| Chr()          | ASCII码值转换成字符        |
| **Fix()**      | 取整                  |
| Hex()          | 十进制数转换成十六进制数        |
| **Int()**      | 取小于或等于N的最大整数        |
| LCase()        | 字母转化成小写字母           |
| Oct()          | 十进制数转换成八进制数         |
| Round()        | 四舍五入取整              |
| Str()          | 数值转化成字符串            |
| UCase()        | 字母转化成大写字母           |
| Val()          | 数字字符转化成数字           |
| Instr（c1,c2)   | 在C1中查找C2存在的位置，找不到为0 |
| Left(C,N)      | 取出字符串左边N个字符         |
| Len(c)         | 求字符串长度              |
| Mid(c,n1[,n2]) | 从字符串c中，n1开始取n2个字符   |
| Right(C,N)     | 取出字符串右边N个字符         |
| Space(N)       | 产生N个空格的字符串          |
| String(N,C)    | 产生由N个C中首字符组成的字符串    |
| Trim(C)        | 去掉字符串前后空格           |
### 3.5.4 格式输出函数
形式为：  

```vb
Format(表达式，"格式字符串"）  
```

其中：  
表达式：要格式化的数值，日期，字符串类型表达式  
格式字符串：数值格式、日期格式、字符串格式
#### 常用的数值型格式说明字符

| 字符  | 说明                                            | 例子                                           |
| --- | --------------------------------------------- | -------------------------------------------- |
| #   | 如果表达式在格式字符串中#的位置上有数字存在，那么就显示出来；否则，该位置就什么都不显示。 | Format(123.45,"####.###")<br><br>返回：123.45   |
| 0   | 如果表达式在格式字符串中0的位置上有一位数字存在，那么就显示出来；否则，就以零显示。    | Format(123.45,"0000.000")<br><br>返回：0123.450 |
| ,   | 千分位符号占位符                                      | Format(1234.5,"#，###.###")<br><br>返回：1,234.5 |
| %   | 表达式乘以100。而百分号(%)会插入到格式字符串中出现的位置上              | Format(0.12345,"0.00%")<br><br>返回：12.35%     |
#### 常用的时间日期型格式说明字符

| 字符     | 说明                                                          | 例子                                            |
| ------ | ----------------------------------------------------------- | --------------------------------------------- |
| dddddd | 以完整日期表示法显示日期毓数(包括年、月、日)                                     | Format(Date,"dddddd")<br><br>返回：2002年7月5日     |
| mmm    | 以全称来表示月(January-December)                                   | Format(Date,"mmmm")<br><br>返回：May             |
| Yyyy   | 以四位数来表示年                                                    | Format(Date,"yyyy")<br><br>返回：2002            |
| Hh     | 以有前导零的数字来显示小时(00~23)                                        |                                               |
| Nn     | 以有前导零的数字来显示分(00~59)                                         |                                               |
| Ss     | 以有前导零的数字来显示秒(00~59)                                         | Format(Time,"Hh:Nn:Ss")<br><br>返回：20:56:01    |
| Tttt   | 以完整时间表示法显示(包括时、分、秒)，用系统识别的时间格式定义的时间分隔符进行格式化。缺省的时间格式为h:mm:ss | Format(Time,"tttt")<br><br>返回：20:57:06        |
| AM/PM  | 在中午前以12小时配合大写AM符号来使用；在中午和11：59P.M.间以12小时配合大写PM来使用           | Format(Time,"ttttAM/PM")<br><br>返回：20:57:46PM |
#### 常用的字符型格式说明字符

| 字符  | 说明                                                                                             | 例子                                          |
| --- | ---------------------------------------------------------------------------------------------- | ------------------------------------------- |
| @   | 字符占位符。显示字符或是空白。如果字符串在格式字符串中@的位置有字符存在，那么就显示出来；否则，就在那个位置上显示空白。除非有惊叹号字符(!)在格式字符串中，否则字符占位符将由右而左被填充 | Format("Abab","@@@@@@")<br><br>返回："  Abab"  |
| &   | 字符占位符。显示字符或什么都不显示。如果字符串在格式字符串有字符&存在，那么就显示出来；否则，就什么都不显示。除非有惊叹号在格式字符串中，否则，字符占位各个地区之间将由右而左被填充。    | Format("Abab","&&&&&&")<br><br>返回："Abab"    |
| <   | 强制小写。将所有字符以小写格式显示                                                                              | Format("Abab","<@@@@@@")<br><br>返回："  abab" |
| >   | 强制大写。将所有字符以大写格式显示。                                                                             | Format("Abab",">@@@@@@")<br><br>返回："  ABAB" |
| !   | 强制由左而右填充字符占位符。缺省值是由右而左填充字符占位符                                                                  | Format("Abab","!@@@@@@")<br><br>返回："Abab  " |
